<!DOCTYPE html>
<!--
Formulario para iniciar uma analise.
Recebe os dados do processo da LEAD
incluindo a documentação.
Pré-visualização dos documentos.
-->
<div class="container-fluid">
    <div class="row" style="margin-top: 0; margin-bottom: 10px">
        <div class="col-xs-6">
            <div class="text-center">
                <button class="btn btn-default btn-block" onclick="window.history.back()">Voltar á Listagem</button>
            </div>
        </div>
        <!-- Butões para chamadas -->
        <div class="col-xs-6 call-buttons">
            <button class="btn btn-success col-xs-12" ng-if="!onCall" ng-click="fazerChamada(dl.id)">
                <i class="fa fa-phone"></i> Ligar
            </button>
            <button class="btn btn-danger col-xs-6" ng-if="onCall" ng-click="terminarChamada(dl.id)">
                <i class="fa fa-phone-volume"></i> Desligar
            </button>
            <button class="btn btn-default col-xs-6" ng-if="onCall" ng-click="naoAtende(dl.id)">
                <i class="fa fa-phone-slash"></i> Não Atende
            </button>                    
        </div>

    </div>
    <div class="row">
        <!-- Informações da LEAD/processo -->
        <div class="col-xs-12 col-md-5" style="border-right: #1b6d85 3px inset; font-family: sans-serif;font-size: .8em ">


            <!-- TABS -->
            <div id="tabs" class="">
                <ul>
                    <li class="tabb" ng-repeat="tab in tabs" 
                        ng-class="{active:isActiveTab(tab.id)}" 
                        ng-click="onClickTab(tab)">
                        {{tab.title}}
                    </li>
                </ul>
            </div>
            <!--Dados da LEAD   -->
            <div id="zero.tpl" class="pn show">
                <div id="viewZero" class="">        
                    <div class="panel">
                        <br/>
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary">{{dl.id}} [ {{dl.tipo}} ]</strong> - Informação da LEAD </h4>
                        </div>
                        <div class="panel-body">
                            <div class="col-xs-12">
                                <div class="form-group-sm col-sm-5">
                                    <label>Fornecedor</label>
                                    <input type="text" class="form-control" ng-model="dl.fornecedornome" readonly=""/>
                                </div>
                                <div class="form-group-sm col-sm-5">
                                    <label>Origem</label>
                                    <input type="text" class="form-control" ng-model="dl.nomelead" readonly=""/>
                                </div>                                
                                <div class="form-group-sm col-sm-2">
                                    <label>LEAD original</label>
                                    <input type="text" class="form-control" ng-model="dl.idleadorig" readonly=""/>
                                </div>
                                <div class="form-group-sm col-sm-4">
                                    <label>Data Entrada</label>
                                    <input type="text" class="form-control" ng-model="dl.dataentrada" readonly=""/>
                                </div>                
                                <div class="form-group-sm col-sm-4">
                                    <label>Situação</label>
                                    <input type="text" class="form-control" ng-model="dl.nomestatus" readonly=""/>
                                </div>
                                <div class="form-group-sm col-sm-4">
                                    <label>Data Situação</label>
                                    <input type="text" class="form-control" ng-model="dl.datastatus" readonly=""/>
                                </div>
                                <div class="form-group-sm col-sm-6">
                                    <label>Gestor</label>
                                    <input type="text" class="form-control" ng-model="dl.gestor" readonly=""/>
                                </div>
                                <div class="form-group-sm col-sm-12">
                                    <label>Situação do crédito</label>
                                    <input type="text" class="form-control" ng-model="dl.situacao" readonly=""/>
                                </div>
                                <div class="form-group-sm col-sm-12">
                                    <label>Informações </label>
                                    <input type="text" class="form-control" ng-model="dl.info" readonly=""/>
                                </div>                    
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--Dados do cliente   -->
            <div id="one.tpl" class="pn hide">
                <div id="viewOne" class="">        
                    <div class="panel">
                        <br/>
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary">{{dl.id}}</strong> - Informação do Cliente</h4>
                        </div>
                        <div class="panel-body">
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-10">
                                    <label>Nome </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.nome" title="{{ic.nome}}"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Idade </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.idade"/>
                                </div>
                                <div class="form-group-sm col-xs-3">
                                    <label>Telefone </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.telefone"/>
                                </div>
                                <div class="form-group-sm col-xs-9">
                                    <label>Email </label>
                                    <input id="emailToCopy" readonly=""  class="form-control" type="text" ng-click="copyToClip()" ng-model="ic.email" title="Click para copiar"/>
                                </div>                        
                                <div class="form-group-sm col-xs-3">
                                    <label>NIF </label>
                                    <input readonly  class="form-control" type="text" ng-model="ic.nif"/>
                                </div>
                                <div class="form-group-sm col-sm-2">
                                    <label>IRS</label>
                                    <input type="text" class="form-control" ng-model="ic.irs" ng-readonly="true"/>
                                </div>                                
                                <div class="form-group-sm col-xs-3">
                                    <label>Estado Civil </label>
                                    <select readonly disabled="" class="form-control" ng-model="ic.estadocivil">
                                        <option ng-repeat="ec in estadoscivis" ng-value="ec.id" ng-selected="ic.estadocivil == ec.id">{{ec.nome}}</option>
                                    </select>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Filhos </label>
                                    <input readonly class="form-control" type="text"  ng-model="ic.filhos"/>
                                </div>
                                <div class="form-group-sm col-xs-3">
                                    <label>Sector </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.profissao"/>
                                </div>                                
                                <div class="form-group-sm col-xs-3">
                                    <label>Tipo contrato </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.nomecontrato"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Mês inicio</label>
                                    <select class="form-control" ng-model="ic.mesinicio"  ng-disabled="readOnly" >
                                        <option>..</option>
                                        <option value="1" ng-selected="ic.mesinicio == 1">Janeiro</option>
                                        <option value="2" ng-selected="ic.mesinicio == 2">Fevereiro</option>
                                        <option value="3" ng-selected="ic.mesinicio == 3">Março</option>
                                        <option value="4" ng-selected="ic.mesinicio == 4">Abril</option>
                                        <option value="5" ng-selected="ic.mesinicio == 5">Maio</option>
                                        <option value="6" ng-selected="ic.mesinicio == 6">Junho</option>
                                        <option value="7" ng-selected="ic.mesinicio == 7">Julho</option>
                                        <option value="8" ng-selected="ic.mesinicio == 8">Agosto</option>
                                        <option value="9" ng-selected="ic.mesinicio == 9">Setembro</option>
                                        <option value="10" ng-selected="ic.mesinicio == 10">Outubro</option>
                                        <option value="11" ng-selected="ic.mesinicio == 11">Novembro</option>
                                        <option value="12" ng-selected="ic.mesinicio == 12">Dezembro</option>
                                    </select>
                                </div> 
                                <div class="form-group-sm col-xs-2">
                                    <label>Inicio </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.anoinicio"/>
                                </div>                                
                                <div class="form-group-sm col-xs-2">
                                    <label>Vencimento </label>
                                    <input type="text" class="form-control" ng-model="ic.vencimento"  disabled="disabled"/>
                                </div>                                
                            </div>

                            <!-- Habitação -->
                            <div class="col-xs-12">
                                <div class="form-group-sm col-sm-4">
                                    <label>Habitação</label>
                                    <input type="text" class="form-control" ng-model="ic.nomehabitacao" ng-readonly="true"/>
                                </div>
                                <div class="form-group-sm col-sm-2" ng-if="ic.valorhabitacao > 0">
                                    <label>Renda/Prestação</label>
                                    <input type="text" class="form-control"  ng-model="ic.valorhabitacao" ng-readonly="true"/>
                                </div>
                                <div class="form-group-sm col-sm-2">
                                    <label>Inicio</label>
                                    <input type="text" class="form-control" ng-model="ic.anoiniciohabitacao" ng-readonly="true"/>
                                </div>                 
                                <div class="form-group-sm col-sm-2" ng-if="ic.declarada">
                                    <label>Declarada</label>
                                    <input type="text" class="form-control" ng-model="ic.declarada" ng-readonly="true"/>
                                </div>
                                <div class="form-group-sm col-sm-2" ng-if="ic.mesmahabitacao">
                                    <label class="text-info">Mesma</label>
                                    <input type="text" class="form-control" ng-model="ic.mesmahabitacao" ng-readonly="true"/>
                                </div>
                                <div ng-if="ic.mesmahabitacao == 'Não'">
                                    <div class="form-group-sm col-sm-4">
                                        <label class="text-info">Habitação 2º</label>
                                        <input type="text" class="form-control" ng-model="ic.nomehabitacao2" ng-readonly="true"/>
                                    </div>
                                    <div class="form-group-sm col-sm-2" ng-if="ic.valorhabitacao2 > 0">
                                        <label class="text-info">Renda/Prestação</label>
                                        <input type="text" class="form-control"  ng-model="ic.valorhabitacao2" ng-readonly="true"/>
                                    </div>
                                    <div class="form-group-sm col-sm-2">
                                        <label class="text-info">Inicio</label>
                                        <input type="text" class="form-control" ng-model="ic.anoiniciohabitacao2" ng-readonly="true"/>
                                    </div>                 
                                    <div class="form-group-sm col-sm-2" ng-if="ic.declarada2">
                                        <label class="text-info">Declarada</label>
                                        <input type="text" class="form-control" ng-model="ic.declarada2" ng-readonly="true"/>
                                    </div> 
                                </div>
                            </div>
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-2">
                                    <label class="text-info">2º Titular </label>
                                    <input disabled class="form-control" type="checkbox" ng-model="ic.segundoproponente" ng-checked="ic.segundoproponente == 1"/>
                                </div>  
                                <div class="form-group-sm col-xs-2">
                                    <label class="text-info">Parentesco </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.parentesco2"/>
                                </div>                                
                                <div class="form-group-sm col-xs-2">
                                    <label class="text-info">Idade 2º Prop. </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.idade2"/>
                                </div>
                                <div class="form-group-sm col-xs-3">
                                    <label class="text-info">Telefone </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.telefone2"/>
                                </div>
                                <div class="form-group-sm col-xs-3">
                                    <label class="text-info">NIF </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.nif2"/>
                                </div>
                                <div class="form-group-sm col-xs-3">
                                    <label class="text-info">Sector </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.profissao2"/>
                                </div>                                
                                <div class="form-group-sm col-xs-3">
                                    <label class="text-info">Tipo contrato </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.nomecontrato2"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Mês inicio</label>
                                    <select class="form-control" ng-model="ic.mesinicio2"  ng-disabled="readOnly" >
                                        <option>..</option>
                                        <option value="1" ng-selected="ic.mesinicio2 == 1">Janeiro</option>
                                        <option value="2" ng-selected="ic.mesinicio2 == 2">Fevereiro</option>
                                        <option value="3" ng-selected="ic.mesinicio2 == 3">Março</option>
                                        <option value="4" ng-selected="ic.mesinicio2 == 4">Abril</option>
                                        <option value="5" ng-selected="ic.mesinicio2 == 5">Maio</option>
                                        <option value="6" ng-selected="ic.mesinicio2 == 6">Junho</option>
                                        <option value="7" ng-selected="ic.mesinicio2 == 7">Julho</option>
                                        <option value="8" ng-selected="ic.mesinicio2 == 8">Agosto</option>
                                        <option value="9" ng-selected="ic.mesinicio2 == 9">Setembro</option>
                                        <option value="10" ng-selected="ic.mesinicio2 == 10">Outubro</option>
                                        <option value="11" ng-selected="ic.mesinicio2 == 11">Novembro</option>
                                        <option value="12" ng-selected="ic.mesinicio2 == 12">Dezembro</option>
                                    </select>
                                </div>                                 
                                <div class="form-group-sm col-xs-2">
                                    <label class="text-info">Ano Inicio</label>
                                    <input readonly class="form-control" type="text" ng-model="ic.anoinicio2"/>
                                </div>                                
                                <div class="form-group-sm col-xs-2">
                                    <label class="text-info">Vencimento </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.vencimento2"/>
                                </div>
                                <div class="form-group-sm col-xs-12">
                                    <label>Outras Informações:</label>
                                    <textarea class="form-control" ng-readonly="true">{{ic.outrainfo}}</textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--  Credito Pretendido/Rendimentos/Despesas  -->
            <div id="two.tpl" class="pn hide">
                <div id="viewTwo" class="">
                    <div class="panel">
                        <br/>
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary">{{dl.id}}</strong> - Crédito Pretendido</h4>
                        </div>
                        <div class="panel-body">
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-2">
                                    <label for="montante">Valor Pretendido</label>
                                    <input id="montante" name="montante" string-to-number  class="form-control no-spinner" min="0" type="number" ng-model="ic.valorpretendido" ng-readonly="readOnly"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label for="tipoLead">Tipo Crédito</label>                
                                    <select id="tipoLead" class="form-control" ng-model="ic.tipocredito" ng-disabled="readOnly">
                                        <option value="CP" ng-selected="ic.tipocredito == 'CP'" title="Crédito Pessoal">CP</option>
                                        <option value="CC" ng-selected="ic.tipocredito == 'CC'" title="Crédito Consolidado">CC</option>
                                        <option value="CT" ng-selected="ic.tipocredito == 'CT'" title="Cartão de Crédito">Cartão</option>
                                        <option value="AU" ng-selected="ic.tipocredito == 'AU'" title="Crédito Automovel">Auto</option>
                                        <option value="CHCC" ng-selected="ic.tipocredito == 'CHCC'" title="Hipotecário consolidado com CH">CHCC</option>
                                        <option value="CH1" ng-selected="ic.tipocredito == 'CH1'" title="Hipotecário com 1ª hipoteca">HipCH1</option>
                                        <option value="CH2" ng-selected="ic.tipocredito == 'CH2'" title="Hipotecário com 2ª hipoteca">HipCH2</option>
                                    </select>
                                </div>                
                                <div class="form-group-sm col-xs-2">
                                    <label for="numprestacoes">Prazo </label>
                                    <input id="numprestacoes" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="ic.prazopretendido" ng-readonly="readOnly"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label for="valorprestacao">Prestação </label>
                                    <input id="valorprestacao" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="ic.prestacaopretendida"  ng-readonly="readOnly"/>
                                </div>
                                <!--                            <div class="form-group-sm col-xs-2">
                                                                <label for="diaprestacao">Dia pag </label>
                                                                <input id="diaprestacao" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="ic.diaprestacao"  ng-readonly="readOnly"/>
                                                            </div>     -->                           
                                <div class="form-group-sm col-xs-4">
                                    <label for="finalidade">Finalidade</label>
                                    <textarea id="finalidade" name="finalidade" class="form-control" ng-model="ic.finalidade" readonly="readOnly" rows="2"></textarea>
                                    <!-- <input id="finalidade" name="finalidade" class="form-control" type="text" ng-model="ic.finalidade"  ng-readonly="readOnly"/> -->
                                </div>
                            </div>
                            <div class="col-xs-12">
                                <br/>
                                <table class="table table-condensed">
                                    <thead>
                                    <th colspan="4" class="text-center text-info">Outros Rendimentos  &nbsp;&nbsp;
                                        <button class="btn btn-default btn-sm" ng-click="addNewOR = !addNewOR" title="Adicionar linha."><i class="fa fa-plus"></i></button>
                                    </th>
                                    <tr ng-show="rendimentos != ''" >
                                        <th>Tipo de rendimento</th>
                                        <th>Valor</th>
                                        <th>Periocidade</th>
                                        <th>Aplicar</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="r in rendimentos">
                                            <td class="text-white">{{r.tiporendimento}}</td>
                                            <td class="text-white">{{r.valorrendimento}}€</td>
                                            <td class="text-white">{{r.periocidade}}</td>
                                            <td class="form-group-sm">
                                                <select class="form-control" ng-model="r.usar" ng-change="saveAplicar(r)">
                                                    <option value="1" ng-selected="r.usar == 1">Sim</option>
                                                    <option value="0" ng-selected="r.usar == 0">Não</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr ng-if="addNewOR">
                                            <td class="text-white">
                                                <input class="form-control" type="text" ng-model="or.tiporendimento"/>
                                            </td>
                                            <td>
                                                <input class="form-control" type="number" ng-model="or.valorrendimento"/>
                                            </td>
                                            <td>
                                                <select class="form-control" name="periocidade" ng-model="or.periocidade">
                                                    <option value="Mes">Mensal</option>
                                                    <option value="Ano">Anual</option>
                                                </select>
                                            </td>
                                            <td>
                                                <button class="btn btn-sm btn-primary" ng-click="saveLinhaOR(or)" title="Guarda a nova linha"><i class="fa fa-check"></i></button>
                                            </td>
                                        </tr>   
                                    </tbody>
                                </table>
                                <!-- Outros Creditos -->
                                <br/>
                                <table class="table table-condensed table-responsive"  ng-init="totalCreditos = 0; totalPrestacao = 0" >
                                    <thead>
                                        <tr>
                                            <th colspan="6" class="text-center text-info">Outros Créditos &nbsp;&nbsp;
                                                <button class="btn btn-default btn-sm" ng-click="addNewOC = !addNewOC" title="Adicionar linha."><i class="fa fa-plus"></i></button>
                                            </th>
                                        </tr>                        
                                        <tr ng-show="creditos != ''">
                                            <th>Tipo de Crédito</th>
                                            <th>Valor Crédito</th>
                                            <th>Prestação</th>
                                            <th>Liquidar</th>
                                            <th>Opção Analista</th>
                                            <th>Data da alteração</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="c in creditos" >
                                            <td class="text-white">{{c.tipocredito}}</td>
                                            <td class="text-white">{{c.valorcredito}}€</td>
                                            <td class="text-white">{{c.prestacao}}€</td>
                                            <td class="text-white" ng-if="c.liquidar == 1">SIM</td>
                                            <td class="text-danger" ng-if="c.liquidar == 0">NÃO</td>   
                                            <td class="form-group-sm">
                                                <select class="form-control" ng-model="c.adminchoice" ng-change="saveAnaChoice(c)">
                                                    <option value="1" ng-selected="c.adminchoice == 1">Sim</option>
                                                    <option value="0" ng-selected="c.adminchoice == 0">Não</option>
                                                </select>
                                            </td>
                                            <td>{{c.datachoice}}</td>
                                        </tr>
                                        <tr ng-if="addNewOC">
                                            <td class="text-white">
                                                <input class="form-control" type="text" ng-model="oc.tipocredito"/>
                                            </td>
                                            <td>
                                                <input class="form-control" type="number" ng-model="oc.valorcredito"/>
                                            </td>
                                            <td>
                                                <input class="form-control" type="number" ng-model="oc.prestacao"/>
                                            </td>
                                            <td>
                                                <select  class="form-control" ng-model="oc.liquidar">
                                                    <option ng-value="1">Sim</option>
                                                    <option ng-value="0">Não</option>
                                                </select>
                                            </td>
                                            <td>
                                                <button class="btn btn-sm btn-primary" ng-click="saveLinha(oc)" title="Guarda a nova linha"><i class="fa fa-check"></i></button>
                                            </td>
                                        </tr> 
                                        <tr style="font-size: 1.4em">
                                            <th>Totais: 
                                            <th> {{totalCreditos}} €</th>
                                            <th> {{totalPrestacoes}} €</th>
                                        </tr>
                                    </tbody>
                                </table>   
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Situação Financeira -->
            <div id="four.tpl" class="pn hide">
                <div id="viewFour" class="">
                    <div class="panel">
                        <br/>
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary">{{dl.id}}</strong> - Situação Financeira</h4>
                        </div>
                        <div class="panel-body">
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-2">
                                    <label>Vencimento</label>
                                    <input  class="form-control" type="text" ng-model="ic.vencimento" ng-change="checkParceiros()"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Venc. 2º Prop </label>
                                    <input  class="form-control" type="text" ng-model="ic.vencimento2" ng-change="checkParceiros()"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Venc x14/12 </label>
                                    <input  class="form-control" type="text" ng-model="ic.venc_cetelem"  ng-change="checkParceiros()"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Venc x14/12 - 2T</label>
                                    <input  class="form-control" type="text" ng-model="ic.venc_cetelem2" ng-change="checkParceiros()"/>
                                </div>                                
                                <div class="form-group-sm col-xs-2">
                                    <label>O. Rend. </label>
                                    <input class="form-control" type="text" ng-model="ic.outrosrendimentos"  ng-change="checkParceiros()"/>
                                </div> 
                                <div class="form-group-sm col-xs-2">
                                    <label>Rend. Liq. </label>
                                    <input readonly="" class="form-control" type="text" ng-model="RLiq"/>
                                </div>                                 
                            </div>
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-3">
                                    <label>Outros Créditos </label>
                                    <input   class="form-control" type="text" ng-model="ic.outroscreditos"  ng-change="checkParceiros()"/>
                                </div>                        
                                <div class="form-group-sm col-xs-3">
                                    <label>Renda / C.Hab. </label>
                                    <input  class="form-control" type="text" ng-model="ic.valorhabitacao" ng-change="checkParceiros()"/>
                                </div>

                                <div class="form-group-sm col-xs-3">
                                    <label>Filhos </label>
                                    <input  class="form-control" type="text" ng-model="ic.filhos"  ng-change="checkParceiros()"/>
                                </div> 
                                <div class="form-group-sm col-xs-3">
                                    <label>Rend. Liq. 14/12 </label>
                                    <input readonly="" class="form-control" type="text" ng-model="RLiqCt"/>
                                </div>  
                            </div>
                            <!-- Tipo de credito-->
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-3">
                                    <label>Valor Pretendido </label>
                                    <input readonly="" class="form-control" type="text" ng-model="ic.valorpretendido"/>
                                </div>   
                                <div class="form-group-sm col-xs-2">
                                    <label>Prest. </label>
                                    <input  readonly=""  class="form-control" type="text" ng-model="ic.prestacaopretendida"/>
                                </div>  
                                <div class="form-group-sm col-xs-2">
                                    <label>Prazo</label>
                                    <input  readonly=""  class="form-control" type="text" ng-model="ic.prazopretendido"/>
                                </div>  
                                <div class="form-group-sm col-xs-2">
                                    <label>2º Titular</label>
                                    <select disabled="" ng-model="ic.segundoproponente" class="form-control">
                                        <option value="1" ng-selected="ic.segundoproponente == 1" >Sim</option>
                                        <option value="0" ng-selected="ic.segundoproponente == 0" >Não</option>
                                    </select>
                                </div>                                  
                                <div class="form-group-sm col-xs-3">
                                    <label>Tipo de Credito </label>
                                    <select disabled="" class="form-control" ng-model="ic.tipocredito">
                                        <option value="CP" ng-selected="ic.tipocredito == 'CP'">Pessoal</option>
                                        <option value="CC" ng-selected="ic.tipocredito == 'CC'">Consolidado</option>
                                        <option value="AU" ng-selected="ic.tipocredito == 'AU'">Automovel</option>
                                        <option value="CHCC" ng-selected="s.tipocredito == 'CHCC'">Hip. CH CC</option>
                                        <option value="CH1" ng-selected="s.tipocredito == 'CH1'">Hip. CH1</option>
                                        <option value="CH2" ng-selected="s.tipocredito == 'CH2'">Hip. CH2</option>
                                    </select>
                                </div>                              
                            </div>
                            <!-- Simulação-->
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-3">
                                    <input  class="form-control" type="text" ng-model="s.valorpretendido" ng-change="checkParceiros()"/>
                                </div>   
                                <div class="form-group-sm col-xs-2">
                                    <input  class="form-control" type="text" ng-model="s.prestacaopretendida" ng-change="checkParceiros()"/>
                                </div>  
                                <div class="form-group-sm col-xs-2">
                                    <input  class="form-control" type="text" ng-model="s.prazopretendido" ng-change="checkParceiros()"/>
                                </div>  
                                <div class="form-group-sm col-xs-2">
                                    <select ng-model="s.segundoproponente" class="form-control" ng-change="checkParceiros()">
                                        <option value="1" ng-selected="s.segundoproponente == 1" >Sim</option>
                                        <option value="0" ng-selected="s.segundoproponente == 0" >Não</option>
                                    </select>
                                </div>                                  
                                <div class="form-group-sm col-xs-3">
                                    <select class="form-control" ng-model="s.tipocredito" ng-change="checkParceiros()">
                                        <option value="CP" ng-selected="s.tipocredito == 'CP'">Pessoal</option>
                                        <option value="CC" ng-selected="s.tipocredito == 'CC'">Consolidado</option>
                                        <option value="AU" ng-selected="s.tipocredito == 'AU'">Automovel</option>
                                        <option value="CHCC" ng-selected="s.tipocredito == 'CHCC'">Hip. CH CC</option>
                                        <option value="CH1" ng-selected="s.tipocredito == 'CHC1'">Hip. CH1</option>
                                        <option value="CH2" ng-selected="s.tipocredito == 'CHC2'">Hip. CH2</option>
                                    </select>
                                </div>                              
                            </div>                            
                            <div class="col-xs-8 col-sm-offset-2">
                                <div class="col-xs-6" style="margin-top: 20px; margin-bottom: 20px">
                                    <button class="btn btn-block btn-warning" ng-click="getSimulacoes(dl.id)">
                                        Simulações Guardadas
                                    </button>
                                </div>
                                <div class="col-xs-6" style="margin-top: 20px; margin-bottom: 20px">
                                    <button class="btn btn-block btn-info" ng-click="saveChangesFin()">
                                        Guardar Simulação
                                    </button>
                                </div>
                            </div>
                            <!-- Listagem dos resultados aplicados ás regras dos parceiros -->
                            <div class="col-xs-12">
                                <h4 class="text-center text-info">Parceiros Financeiros</h4>
                                <table class="table table-bordered table-hover table-striped">
                                    <thead class="thead thead-dark">
                                        <tr>
                                            <th>Parceiro</th>
                                            <th>Tipo crédito</th>
                                            <th>Tx esforço</th>
                                            <th>Disp. Orçamental</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="p in parceirosChk">
                                            <th ng-class="p.parceiroOk" title="{{p.motivo}}">{{p.nome}}</th>
                                            <td>{{p.tc_descricao}}</td>
                                            <td class="text-primary text-right">{{p.txEsf}} %</td>
                                            <td ng-if="p.disp > 0" class="text-primary text-right" >{{p.disp}} €</td>
                                            <td ng-if="p.disp <= 0" class="text-danger text-right" >{{p.disp}} €</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Formulario do processo -->
            <div id="five.tpl" class="pn hide">
                <div id="viewFive" class="">
                    <div class="panel">
                        <br/>
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary">{{dl.id}}</strong> - Processo</h4>
                        </div>
                        <!-- Dados Pessoais -->
                        <div class="panel-body">
                            <ul class="nav nav-pills">
                                <li role="presentation" ng-class="firstT"><a href="" ng-click="titular = 'primeiro'; secondT = ''; firstT = 'active'">1º Titular</a></li>
                                <li role="presentation" ng-class="secondT"><a href="" ng-click="titular = 'segundo'; secondT = 'active'; firstT = ''">2º Titular</a></li>
                                <li role="presentation" ng-if="p.segundoproponente == 1"><i class="fa fa-check fa-2x text-success"></i></li> 
                            </ul>
                            <!-- PAINEL do 1º TITULAR -->
                            <div class="primeiro-titular" ng-show="titular == 'primeiro'">
                                <br/>
                                <div class="col-xs-12">
                                    <label class="text-primary text-uppercase">Dados Pessoais</label>
                                </div>
                                <div class="col-xs-12">
                                    <div class="form-group col-xs-6">
                                        <label  ngclipboard data-clipboard-target="#nome">Nome</label>
                                        <input id="nome" class="form-control" type="text" ng-model="p.nome">
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label  ngclipboard data-clipboard-target="#datanascimento">Data de nascimento</label>
                                        <input id="datanascimento" class="form-control" type="text" ng-model="p.datanascimento" placeholder="dd-mm-aaaa">
                                    </div> 
                                    <div class="form-group col-xs-3">
                                        <label ngclipboard data-clipboard-target="#nif">NIF</label>
                                        <input id="nif" class="form-control" type="text" ng-model="p.nif">
                                    </div> 
                                    <!-- segunda linha -->
                                    <div class="form group col-xs-4">
                                        <label >Documento Identificação</label>
                                        <select  class="form-control" ng-model="p.tipodoc">
                                            <option  ng-repeat="d in tiposdoc track by d.id" ng-selected='p.tipodoc == d.id' ng-value="d.id">{{d.nome}}</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label ngclipboard data-clipboard-target="#numdoc">Numero Documento</label>
                                        <input id="numdoc" class="form-control" type="text" ng-model="p.numdocumento">
                                    </div>                                     
                                    <div class="form-group col-xs-2">
                                        <label ngclipboard data-clipboard-target="#validade">Validade</label>
                                        <input id="validade" class="form-control" type="text" ng-model="p.validade"  style="font-size: 1.1em" placeholder="dd-mm-aaaa">
                                    </div> 
                                    <div class="form-group col-xs-3">
                                        <label>Nacionalidade</label>
                                        <select class="form-control" ng-model="p.nacionalidade">
                                            <option value="portuguesa" ng-selected="p.nacionalidade == ''">portuguesa</option>
                                            <option ng-repeat="n in nacionalidades"  ng-value="n.nacionalidade" ng-selected="n.nacionalidade == p.nacionalidade">{{n.nacionalidade}}</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-xs-4">
                                        <label>Estado Civil</label>
                                        <select class="form-control" ng-model="p.estadocivil" >
                                            <option ng-repeat="ec in estadoscivis track by ec.id" ng-selected="p.estadocivil == ec.id" ng-value="ec.id">{{ec.nome}}</option>
                                        </select>
                                    </div> 
                                    <div class="form-group col-xs-2">
                                        <label ngclipboard data-clipboard-target="#filhos">Filhos</label>
                                        <input id="filhos" class="form-control" type="text" ng-model="p.filhos">
                                    </div>
                                    <!--         <div class="form-group col-xs-2">
                                                 <label>2º Titular</label>
                                                 <input class="form-control" type="checkbox" ng-model="p.segundoproponente" ng-change="clear2TitularDados(p.segundoproponente)"
                                                        ng-checked="p.segundoproponente == true || p.segundoproponente == 1">
                                             </div> -->

                                </div> 

                                <!-- Morada e contactos -->
                                <div class="col-xs-12">
                                    <label class="text-primary text-uppercase">Morada e contactos</label>
                                </div>
                                <div class="col-xs-12">
                                    <div class="form-group col-xs-3">
                                        <label>Tipo de Habitação</label>
                                        <select class="form-control" ng-model="p.tipohabitacao" >
                                            <option ng-repeat="th in tiposhabitacao track by th.id" ng-selected='p.tipohabitacao == th.id' ng-value="th.id">{{th.nome}}</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label  ngclipboard data-clipboard-target="#desde">Desde</label>
                                        <input id="desde" class="form-control" type="text" ng-model="p.anoiniciohabitacao">
                                    </div> 
                                </div>
                                <div class="col-xs-12">
                                    <div class="form-group col-xs-6">
                                        <label  ngclipboard data-clipboard-target="#morada">Morada</label>
                                        <input id="morada" class="form-control" type="text" ng-model="p.morada">
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label  ngclipboard data-clipboard-target="#loc">Localidade</label>
                                        <input id="loc" class="form-control" type="text" ng-model="p.localidade">
                                    </div>  
                                    <div class="form-group col-xs-3">
                                        <label ngclipboard data-clipboard-target="#cp">Codigo Postal</label>
                                        <input id="cp" class="form-control" type="text" ng-model="p.cp">
                                    </div>                                 
                                </div>  

                                <!-- Contactos e emails -->
                                <div class="col-xs-12">
                                    <div class="form-group col-xs-3">
                                        <label ngclipboard data-clipboard-target="#tel">Telefone</label>
                                        <input id="tel" class="form-control" type="text" ng-model="p.telefone">
                                    </div>
                                    <div class="form-group col-xs-6">
                                        <label ngclipboard data-clipboard-target="#email">Email</label>
                                        <input id="email" class="form-control" type="text" ng-model="p.email">
                                    </div> 
                                </div>
                                <!-- Dados Profissionais -->
                                <div class="col-xs-12">
                                    <label class="text-primary text-uppercase">Dados Profissionais</label>
                                </div>
                                <div class="col-xs-12">

                                    <div class="form-group col-xs-3">
                                        <label>Sector</label>
                                        <select class="form-control" ng-model="p.sector">
                                            <option value="Privado" ng-selected="p.sector == 'Privado'">Privado</option>
                                            <option value="Publico" ng-selected="p.sector == 'Publico'">Publico</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label>Tipo Contrato</label>
                                        <select class="form-control" ng-model="p.tipocontrato">
                                            <option ng-repeat="tc in tiposcontrato track by tc.id" ng-selected='p.tipocontrato == tc.id' ng-value="tc.id">{{tc.nome}}</option>
                                        </select>
                                    </div> 
                                    <div class="form-group col-xs-2">
                                        <label ngclipboard data-clipboard-target="#dsd">Desde Ano</label>
                                        <input id="dsd" class="form-control" type="text" ng-model="p.desde">
                                    </div>
                                    <div class="form-group col-xs-2">
                                        <label ngclipboard data-clipboard-target="#dsd">Mês</label>
                                        <select class="form-control" ng-model="p.desdemes">
                                            <option value="1" ng-selected="p.desdemes == 1">Jan</option>
                                            <option value="2" ng-selected="p.desdemes == 2">Fev</option>
                                            <option value="3" ng-selected="p.desdemes == 3">Mar</option>
                                            <option value="4" ng-selected="p.desdemes == 4">Abr</option>
                                            <option value="5" ng-selected="p.desdemes == 5">Mai</option>
                                            <option value="6" ng-selected="p.desdemes == 6">Jun</option>
                                            <option value="7" ng-selected="p.desdemes == 7">Jul</option>
                                            <option value="8" ng-selected="p.desdemes == 8">Ago</option>
                                            <option value="9" ng-selected="p.desdemes == 9">Set</option>
                                            <option value="10" ng-selected="p.desdemes == 10">Out</option>
                                            <option value="11" ng-selected="p.desdemes == 11">Nov</option>
                                            <option value="12" ng-selected="p.desdemes == 12">Dez</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-xs-6">
                                        <label ngclipboard data-clipboard-target="#emp">Nome da Empresa</label>
                                        <input id="emp" class="form-control" type="text" ng-model="p.nomeempresa">
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label ngclipboard data-clipboard-target="#nifemp">NIF Empresa</label>
                                        <input id="nifemp" class="form-control" type="text" ng-model="p.nifempresa">
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label ngclipboard data-clipboard-target="#tlf">Telefone</label>
                                        <input id="tlf" class="form-control" type="text" ng-model="p.telefoneempresa">
                                    </div>
                                </div>

                                <!-- Dados Bancarios -->
                                <div class="col-xs-12">
                                    <label class="text-primary text-uppercase">Dados Bancarios</label>
                                </div>
                                <div class="col-xs-12">
                                    <div class="form-group col-xs-6">
                                        <label ngclipboard data-clipboard-target="#iban">IBAN</label>
                                        <input id="iban" class="form-control" type="text" ng-model="p.iban">
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label  ngclipboard data-clipboard-target="#dsdiban">Desde</label>
                                        <input id="dsdiban" class="form-control" type="text" ng-model="p.ibandesde">
                                    </div>  
                                    <div class="form-group col-xs-3">
                                        <label  ngclipboard data-clipboard-target="#dsdia">Dia Pagamento</label>
                                        <input id="dsdia" class="form-control" type="text" ng-model="p.diaprestacao">
                                    </div>                                         
                                </div> 
                                <div class="col-xs-12">
                                    <button class="btn btn-success btn-block" ng-click="saveProcesso(p)">GUARDAR</button>
                                </div>
                            </div>
                            <!-- Painel do segundo titular -->
                            <div class="segundo-titular" ng-show="titular == 'segundo'">
                                <br/>
                                <div class="col-xs-12">
                                    <div class="form-group col-xs-2">
                                        <label>2º Titular</label>
                                        <input class="form-control" type="checkbox" ng-model="p.segundoproponente" ng-change="clear2TitularDados(p.segundoproponente)"
                                               ng-checked="p.segundoproponente == true || p.segundoproponente == 1">
                                    </div>
                                    <div class="form-group col-xs-4"  ng-if="p.segundoproponente == true || p.segundoproponente == 1">
                                        <label>Relação Familiar</label>
                                        <select class="form-control" ng-model="p.relacaofamiliar" >
                                            <option ng-repeat="rf in relacoesfamiliares track by rf.id" ng-selected="p.relacaofamiliar == rf.id" ng-value="rf.id">{{rf.descricao}}</option>
                                        </select>
                                    </div>  
                                </div>
                                <!--Dados pessoais do segundo titular-->
                                <div class="col-xs-12" ng-if="p.segundoproponente == true || p.segundoproponente == 1">
                                    <div class="form-group col-xs-6">
                                        <label ngclipboard data-clipboard-target="#nome2">Nome do 2º titular</label>
                                        <input id="nome2" class="form-control" type="text" ng-model="p.nome2">
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label  ngclipboard data-clipboard-target="#dtnasc2">Data de nascimento 2ºT</label>
                                        <input id="dtnasc2" class="form-control" type="text" ng-model="p.datanascimento2">
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label  ngclipboard data-clipboard-target="#nif2">NIF 2º titular</label>
                                        <input id="nif2" class="form-control" type="text" ng-model="p.nif2">
                                    </div>                                 
                                    <!-- segunda linha -->
                                    <div class="form group col-xs-4">
                                        <label>Documento Identificação 2ºT</label>
                                        <select class="form-control" ng-model="p.tipodoc2">
                                            <option ng-repeat="d in tiposdoc track by d.id" ng-selected='p.tipodoc2 == d.id' ng-value="d.id">{{d.nome}}</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label  ngclipboard data-clipboard-target="#numdoc2">Numero Documento 2ºT</label>
                                        <input id="numdoc2" class="form-control" type="text" ng-model="p.numdocumento2">
                                    </div>                                     
                                    <div class="form-group col-xs-2">
                                        <label  ngclipboard data-clipboard-target="#validade2">Validade 2ºT</label>
                                        <input id="validade2" class="form-control" type="text" ng-model="p.validade2"  style="font-size: 1.1em">
                                    </div> 
                                    <div class="form-group col-xs-3">
                                        <label  ngclipboard data-clipboard-target="#nac2">Nacionalidade 2ºT</label>
                                        <select class="form-control" ng-model="p.nacionalidade2">
                                            <option value="portuguesa" ng-selected="p.nacionalidade2 == ''">portuguesa</option>
                                            <option ng-repeat="n in nacionalidades"  ng-value="n.nacionalidade" ng-selected="n.nacionalidade == p.nacionalidade2">{{n.nacionalidade}}</option>
                                        </select>
                                    </div>                                
                                    <!--       </div>  -->
                                    <!-- Morada e contactos -->
                                    <div class="col-xs-12">
                                        <label class="text-primary text-uppercase">Morada e contactos</label>
                                    </div>

                                    <!-- morada 2º Titular -->
                                    <div class="col-xs-12">
                                        <div class="form-group col-xs-3">
                                            <label>Mesma do 1º</label>
                                            <input class="form-control" type="checkbox" ng-model="p.mesmahabitacao" ng-change="clearDadoshibitacao2()"
                                                   ng-checked="p.mesmahabitacao == true || p.mesmahabitacao == 1">
                                        </div>                                                

                                        <div ng-if="(!p.mesmahabitacao || p.mesmahabitacao == 0)">

                                            <div class="form-group col-xs-3">
                                                <label>Tipo de Habitação 2º</label>
                                                <select class="form-control" ng-model="p.tipohabitacao2" >
                                                    <option ng-repeat="th in tiposhabitacao track by th.id" ng-selected='p.tipohabitacao2 == th.id' ng-value="th.id">{{th.nome}}</option>
                                                </select>
                                            </div>
                                            <div class="form-group col-xs-3">
                                                <label  ngclipboard data-clipboard-target="#desde2">Desde</label>
                                                <input id="desde2" class="form-control" type="text" ng-model="p.anoiniciohabitacao2">
                                            </div> 
                                        </div>
                                        <div class="col-xs-12">
                                            <div class="form-group col-xs-6">
                                                <label ngclipboard data-clipboard-target="#morada2">Morada do 2º titular</label>
                                                <input id="morada2" class="form-control" type="text" ng-model="p.morada2">
                                            </div>
                                            <div class="form-group col-xs-3">
                                                <label ngclipboard data-clipboard-target="#loc2">Localidade</label>
                                                <input id="loc2" class="form-control" type="text" ng-model="p.localidade2">
                                            </div>  
                                            <div class="form-group col-xs-3">
                                                <label ngclipboard data-clipboard-target="#cp2">Codigo Postal</label>
                                                <input id="cp2" class="form-control" type="text" ng-model="p.cp2">
                                            </div>                                 
                                        </div>  
                                    </div>
                                    <!-- Contactos e emails -->
                                    <div class="col-xs-12">
                                        <div class="form-group col-xs-3">
                                            <label ngclipboard data-clipboard-target="#tel2">Telefone 2ºT</label>
                                            <input id="tel2" class="form-control" type="text" ng-model="p.telefone2">
                                        </div>
                                        <div class="form-group col-xs-6">
                                            <label ngclipboard data-clipboard-target="#email2">Email 2º Titular</label>
                                            <input id="email2" class="form-control" type="text" ng-model="p.email2">
                                        </div> 
                                    </div>
                                    <!-- Dados Profissionais -->
                                    <div class="form-group col-xs-3">
                                        <label>Sector 2ºT</label>
                                        <select class="form-control" ng-model="p.sector2">
                                            <option value="Privado" ng-selected="p.sector2 == 'Privado'">Privado</option>
                                            <option value="Publico" ng-selected="p.sector2 == 'Publico'">Publico</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label>Tipo Contrato 2ºT</label>
                                        <select class="form-control" ng-model="p.tipocontrato2">
                                            <option ng-repeat="tc in tiposcontrato track by tc.id" ng-selected='p.tipocontrato2 == tc.id' ng-value="tc.id">{{tc.nome}}</option>
                                        </select>
                                    </div> 
                                    <div class="form-group col-xs-2">
                                        <label ngclipboard data-clipboard-target="#dsd2">Desde 2ºT</label>
                                        <input id="dsd2" class="form-control" type="text" ng-model="p.desde2">
                                    </div>
                                    <div class="form-group col-xs-2">
                                        <label>Mês</label>
                                        <select class="form-control" ng-model="p.desdemes2">
                                            <option value="1" ng-selected="p.desdemes2 == 1">Jan</option>
                                            <option value="2" ng-selected="p.desdemes2 == 2">Fev</option>
                                            <option value="3" ng-selected="p.desdemes2 == 3">Mar</option>
                                            <option value="4" ng-selected="p.desdemes2 == 4">Abr</option>
                                            <option value="5" ng-selected="p.desdemes2 == 5">Mai</option>
                                            <option value="6" ng-selected="p.desdemes2 == 6">Jun</option>
                                            <option value="7" ng-selected="p.desdemes2 == 7">Jul</option>
                                            <option value="8" ng-selected="p.desdemes2 == 8">Ago</option>
                                            <option value="9" ng-selected="p.desdemes2 == 9">Set</option>
                                            <option value="10" ng-selected="p.desdemes2 == 10">Out</option>
                                            <option value="11" ng-selected="p.desdemes2 == 11">Nov</option>
                                            <option value="12" ng-selected="p.desdemes2 == 12">Dez</option>
                                        </select>
                                    </div>                                
                                    <div class="form-group col-xs-6">
                                        <label ngclipboard data-clipboard-target="#emp2">Nome da Empresa 2ºT</label>
                                        <input id="emp2" class="form-control" type="text" ng-model="p.nomeempresa2">
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label ngclipboard data-clipboard-target="#nifemp2">NIF Empresa 2ºT</label>
                                        <input id="nifemp2" class="form-control" type="text" ng-model="p.nifempresa2">
                                    </div>
                                    <div class="form-group col-xs-3">
                                        <label ngclipboard data-clipboard-target="#tlf2">Telefone 2ºT</label>
                                        <input id="tlf2" class="form-control" type="text" ng-model="p.telefoneempresa2">
                                    </div>                                   
                                    <!-- Botão para guardar -->
                                    <div class="col-xs-12">
                                        <button class="btn btn-success btn-block" ng-click="saveProcesso(p)">GUARDAR</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> 
            <!-- Notas e Observações do Analista-->
            <div id="six.tpl" class="pn hide">
                <div id="viewSix" class="">
                    <div class="panel">
                        <br/>
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary">{{dl.id}}</strong> - Notas</h4>
                        </div>
                        <div class="panel-body">
                            <div class="form-group-sm col-xs-12">
                                <label>Notas:</label>
                                <textarea rows="6" class="form-control" ng-model="ic.nota" ng-readonly="readOnly"></textarea>
                            </div>                            
                        </div>
                        <div class="panel-footer">
                            <button ng-if="readOnly" class="btn btn-info" ng-click="editarNota()"><i class="fa fa-pencil-alt"></i> Editar</button>
                            <button ng-if="!readOnly" class="btn btn-primary" ng-click="salvarNota(dl.id)"><i class="fa fa-save"></i> Guardar</button>
                        </div>
                    </div>
                </div>
            </div>   
            <!-- Comunicações com o cliente-->
            <div id="seven.tpl" class="pn hide">
                <div id="viewSeven" class="">
                    <div class="panel" style="min-height: 400px;">
                        <br/>
                        <div class="panel-heading">
                            <h4><strong class="text-primary">{{dl.id}}</strong> - Comunicações com Cliente</h4>
                        </div>
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-xs-5">
                                    <h4 class="text-info text-center" ng-if="comunicacoes">Histórico de comunicações</h4>
                                    <h4 class="text-info text-center" ng-if="!comunicacoes">Não existem comunicações</h4>
                                    <div class="panel panel-default"  ng-repeat="c in comunicacoes">
                                        <div class="panel-heading" ng-click="selected = $index; show = !show">{{c.data}} - {{c.assunto}}</div>
                                        <div ng-show="selected == $index && show" class="panel-body">
                                            <textarea class="form-control" rows="4">{{c.texto}}</textarea>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-xs-6 bg-info">
                                    <h4 class="text-center">Criar email</h4>
                                    <div class="form-group">
                                        <label>Enviar para</label>
                                        <input class="form-control" type="text" ng-model="ic.email" readonly>
                                    </div>                                        
                                    <div class="form-group">
                                        <label>Assunto</label>
                                        <input class="form-control" type="text" ng-model="e.assunto">
                                    </div>
                                    <div class="form-group">
                                        <label>Texto <small>(Atenção! O [Exmo(a) Nome Cliente] é incluido automaticamente)</small></label>
                                        <textarea class="form-control" rows="6" ng-model="e.texto"></textarea>
                                    </div>
                                    <div class="text-center">
                                        <button class="btn btn-warning" ng-click="e = {}"><i class="fa fa-eraser"></i> Limpar</button>
                                        <button class="btn btn-default" ng-click="enviarComunicacao(e)"><i class="fa fa-envelope text-danger"></i> Enviar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Registo de contactos -->
            <div id="eight.tpl" class="pn hide">
                <div id="viewEight" class="">
                    <div class="panel">
                        <br/>
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary">{{dl.id}}</strong> - Contactos</h4>
                        </div>
                        <div class="panel-body">
                            <table class="table table-condensed" ng-show="contactos != ''">
                                <thead>
                                    <tr>
                                        <th colspan="3" class="text-center">Historico de Contactos</th>
                                    </tr>
                                    <tr>
                                        <th ng-click="reverse = !reverse" style="cursor:pointer" title="Click para ordenar">Data &uarr;&darr;</th>
                                        <th>Motivo</th>
                                        <th>Utilizador</th>
                                        <th>Tipo</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="c in contactos| orderBy: 'data': reverse">
                                        <td>{{c.data}}</td>
                                        <td>{{c.descricao}}</td>
                                        <td>{{c.nome}}</td>
                                        <td>{{c.tipo}}</td>
                                    </tr>
                                </tbody>
                            </table>  
                        </div>
                    </div>
                </div>
            </div>
            <!-- Simulador de Rendimentos -->
            <div id="nine.tpl" class="pn hide">
                <div id="viewNine">
                    <div class="panel">
                        <br/>
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary">{{dl.id}}</strong> - Simulador de Rendimentos</h4>
                        </div>
                        <div class="panel-body">
                            <form>
                                <div class="row">
                                    <div class="form-group col-xs-6">
                                        <label>Situação </label>
                                        <select class="form-control" ng-model="sim.situacao" ng-change="calculaSimula(sim)">
                                            <option value="0">Não Casado</option>
                                            <option value="1">Casado 1 Titular</option>
                                            <option value="2">Casado 2 Titulares</option>
                                        </select>
                                    </div>  
                                    <div class="form-group col-xs-2">
                                        <label>Filhos </label>
                                        <input name="filhos" class="form-control no-spinner" type="number" string-to-number ng-model="sim.filhos" ng-value="ic.filhos" ng-change="calculaSimula(sim)"/>
                                    </div>  
                                    <div class="form-group col-xs-4">
                                        <label>Vencimento base </label>
                                        <input  class="form-control" type="text"  ng-model="sim.vencBase1" style="width: 100px" ng-change="calculaSimula(sim)"/>
                                    </div>
                                    <div class="form-group col-xs-4">
                                        <label>O.R. sujeitos a IRS e SS </label>
                                        <input  class="form-control" type="text" ng-model="sim.outrosRend1" style="width: 100px" ng-change="calculaSimula(sim)"/>
                                    </div> 
                                    <div class="form-group col-xs-4">
                                        <label>O.R. sujeitos apenas a IRS </label>
                                        <input  class="form-control" type="text" ng-model="sim.outrosRendIRS1" style="width: 100px" ng-change="calculaSimula(sim)"/>
                                    </div> 
                                    <div class="form-group col-xs-4">
                                        <label>O.R. Isentos</label>
                                        <input  class="form-control" type="text" ng-model="sim.outrosRendIsentos1" style="width: 100px" ng-change="calculaSimula(sim)"/>
                                    </div> 
                                </div>
                                <div class="row">
                                    <div class="form-group col-xs-4">
                                        <label>Subsidio de Refeição</label>
                                        <select class="form-control" ng-model="sim.subRef1" ng-change="calculaSimula(sim)">
                                            <option value="0">Não tem</option>
                                            <option value="1">Remuneração</option>
                                            <option value="2">Cartão / Vales</option>
                                        </select>
                                    </div>  
                                    <div class="form-group col-xs-3">
                                        <label>Valor diário </label>
                                        <input  class="form-control" type="text"  ng-model="sim.subRefValor1" ng-change="calculaSimula(sim)"/>
                                    </div>  
                                    <div class="form-group col-xs-3">
                                        <label>Dias </label>
                                        <input  class="form-control no-spinner" type="number" string-to-number ng-model="sim.subRefDias1" ng-change="calculaSimula(sim)"/>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-xs-6">
                                        <label>Vencimento líquido (com subsídio alimentação) </label>
                                        <input  class="form-control" type="text" ng-model="sim.vencLiquido1" readonly=""/>
                                    </div>
                                </div>

                                <div ng-if="sim.situacao == 2">
                                    <div class="row">    
                                        <div class="form-group col-xs-4">
                                            <label>Vencimento base 2º titular</label>
                                            <input  class="form-control" type="text" ng-model="sim.vencBase2" style="width:100px" ng-change="calculaSimula(sim)"/>
                                        </div>
                                        <div class="form-group col-xs-4">
                                            <label>O.R. sujeitos a IRS e SS 2º</label>
                                            <input  class="form-control" type="text" ng-model="sim.outrosRend2" style="width: 100px" ng-change="calculaSimula(sim)"/>
                                        </div> 
                                        <div class="form-group col-xs-4">
                                            <label>O.R. sujeitos apenas a IRS 2º</label>
                                            <input  class="form-control" type="text" ng-model="sim.outrosRendIRS2" style="width: 100px" ng-change="calculaSimula(sim)"/>
                                        </div> 
                                        <div class="form-group col-xs-4">
                                            <label>O.R. Isentos 2º</label>
                                            <input  class="form-control" type="text" ng-model="sim.outrosRendIsentos2" style="width: 100px" ng-change="calculaSimula(sim)"/>
                                        </div>                                         
                                    </div>
                                    <div class="row">
                                        <div class="form-group col-xs-4">
                                            <label>Subsidio de Refeição</label>
                                            <select class="form-control" ng-model="sim.subRef2" ng-change="calculaSimula(sim)">
                                                <option value="0">Não tem</option>
                                                <option value="1">Remuneração</option>
                                                <option value="2">Cartão / Vales</option>
                                            </select>
                                        </div>  
                                        <div class="form-group col-xs-3">
                                            <label>Valor diário </label>
                                            <input  class="form-control" type="text" ng-model="sim.subRefValor2" ng-change="calculaSimula(sim)"/>
                                        </div>  
                                        <div class="form-group col-xs-3">
                                            <label>Dias </label>
                                            <input  class="form-control no-spinner" type="number" string-to-number ng-model="sim.subRefDias2" ng-change="calculaSimula(sim)"/>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="form-group col-xs-6">
                                            <label>Vencimento líquido 2º Titular (com subsídio alimentação) </label>
                                            <input  class="form-control" type="text" ng-model="sim.vencLiquido2" readonly=""/>
                                        </div>
                                    </div>
                                </div>
                                <div class="row text-center">
                                    <button class="btn btn-info" ng-click="confirmSimula(sim)"><i class="fa fa-check"></i> Confirmar</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>            
            <!-- Crédito Hipotecário -->
            <div id="ten.tpl" class="pn hide">
                <div id="viewTen">
                    <div class="panel">
                        <br/>
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary">{{dl.id}}</strong> - Crédito Hipotecário</h4>
                        </div>
                        <div class="panel-body">
                            <form>
                                <div class="row">
                                    <div class="form-group col-xs-4">
                                        <label>Valor da Garantia</label>
                                        <input  class="form-control" type="text" ng-model="hip.garantia" ng-change="calcResult()"/>
                                    </div> 
                                    <div class="form-group col-xs-4">
                                        <label>Valor do CH em divida </label>
                                        <input  class="form-control" type="text" ng-model="hip.valordivida" ng-change="calcResult()"/>
                                    </div> 
                                    <div class="form-group col-xs-4">
                                        <label>Valor Pretendido</label>
                                        <input  class="form-control" type="text" ng-model="hip.valorpretendido" ng-change="calcResult()"/>
                                    </div>
                                    
                                    <table class="table table-bordered table-condensed" style="max-width: 700px; margin: auto">
                                        <thead>
                                            <tr>
                                                <th>Parceiro</th>
                                                <th>LTV</th>
                                                <th>Disp. Orçamental</th>
                                                <th>Resultado Final</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="ph in parceiroshipo">
                                                <th>{{ph.nome}}</th>
                                                
                                                <td><input  class="form-control" type="text" ng-value="hip.garantia * ph.tx" readonly/></td>
                                                <td>
                                                    <input class="form-control" type="text" ng-value="hip.garantia * ph.tx - hip.valordivida" ng-model="hip.valorDO"  readonly="">
                                                </td>
                                                <td>
                                                    <input   class="form-control" style="color: white; background-color: {{result}}"  ng-value="(hip.garantia * ph.tx - hip.valordivida) - hip.valorpretendido" readonly=""/>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                    <div class="col-xs-12 text-center">
                                        <button class="btn btn-success" ng-click="saveSimulaHipo()">Guardar</button>
                                    </div>
                                </div>
                            </form>
                    </div>
            </div>
        </div>
    </div>
            <div  ng-if="historic.length > 0"  class="form-group col-xs-12">
                <button class="btn btn-warning btn-block" ng-click="showHistorico(historic)">Histórico</button>
            </div>  
</div>



        <!-- Painel DIREITO Para apresentar Documentação e o formulario-->
        <div class="col-xs-12 col-md-7" style="font-family: sans-serif;font-size: .8em ">
            <!-- Mostra Paineis -->
            <div ng-if="!showDoc">



                <!-- TABRS -->
                <div id="tabrs" class="">
                    <ul>
                        <li class="tabbr" ng-repeat="tabr in tabrs" 
                            ng-class="{active:isActiveTabR(tabr.id)}" 
                            ng-click="onClickTabR(tabr)">
                            {{tabr.title}}
                        </li>
                    </ul>
                </div>

                <!--Dados do parceiro   -->
                <div id="rzero.tpl" class="pnr hide">
                    <div id="viewRZero" class="">
                        <div class="panel">
                            <div class="panel-heading">
                                <h4><strong class="text-primary">{{dl.id}}</strong> - Registo dos Parceiros </h4>
                            </div>
                            <div class="panel-body">
                                <form>
                                    <div class="col-xs-12"  ng-repeat="sbm in sbms track by $index" style="border-bottom: 1px gray solid; padding-bottom: 10px">
                                        <div class="form-group-sm col-xs-2">
                                            <label>Parceiro </label>
                                            <select class="form-control" ng-model="sbm.parceiro" ng-value="sbm[$index].nome">
                                                <option ng-repeat="p in parceiros" value="{{p.id}}" ng-selected="{{sbm.nome == p.nome}}">{{p.nome}}</option>
                                            </select>
                                        </div>  
                                        <div class="form-group-sm col-xs-2">
                                            <label>Nº Processo </label>
                                            <input  class="form-control no-spinner" type="text" ng-model="sbm.processo"/>
                                        </div>  
                                        <div class="form-group-sm col-xs-2">
                                            <label>Montante </label>
                                            <input  class="form-control no-spinner" type="number" string-to-number ng-model="sbm.montante"/>
                                        </div>  
                                        <div class="form-group-sm col-xs-2">
                                            <label>Tipo </label>
                                            <select  class="form-control" type="text" ng-model="sbm.tipocredito" value="{{sbm.tipocredito}}">
                                                <option  value="CP">CP</option>
                                                <option  value="CC">CC</option>
                                                <option   value="AU">Auto</option>
                                                <option value="CHCC">Hip. CH CC</option>
                                                <option value="CH1">Hip. CH1</option>
                                                <option value="CH2">Hip. CH2</option>
                                            </select>
                                        </div>  
                                        <div class="form-group-sm col-xs-2">
                                            <label title="Prazo ou modalidade de pagamento do CC">Prazo - %</label>
                                            <input  class="form-control no-spinner" type="number" string-to-number ng-model="sbm.prazo"/>
                                        </div>  
                                        <div class="form-group-sm col-xs-2">
                                            <label>Prestação </label>
                                            <input  class="form-control no-spinner" type="number" string-to-number ng-model="sbm.prestacao"/>
                                        </div> 

                                        <div class="form-group-sm col-xs-3">
                                            <label>Status</label>
                                            <select class="form-control" ng-model="sbm.status" ng-value="sbm[$index].stsfinanciamento" ng-change="submitProcess(sbm)">
                                                <option value="1" >Em Analise</option>
                                                <option value="2" >Pré-Aprovado</option>
                                                <option value="14" >Pré-Reserva</option>
                                                <option value="6" >Aprovado</option>
                                                <option value="5">Recusado</option>
                                                <option value="4">Incompleto</option>
                                                <option value="3">Motivo F</option>
                                                <option value="9">Cancelado</option>
                                                <option value="11" >Pré-Aprovado CrtEnv</option>
                                                <option value="13" >Não disponivel</option>
                                            </select>
                                        </div>
                                        <div class="form-group-sm col-xs-2">
                                            <label>Data </label>
                                            <p><span class="badge">{{sbm.dtstatus}}</span> </p>                       
                                        </div> 
                                    </div>
                                    <div class="col-xs-12">
                                        <a class="btn btn-sm" title="Adicionar uma linha" ng-click="addLineParceiro()"><i class="fa fa-plus-circle fa-2x"></i></a>
                                    </div>
                                    <br>
                                    <div class="text-center">
                                        <button class="btn btn-info" ng-click="pendente()"><i class="fa fa-hourglass-start"> </i> Pendente</button>
                                        <button class="btn btn-primary" ng-click="aguardarDoc(ic.lead)" ng-if="dl.status != 21"><i class="fa fa-hourglass-half"> </i> Aguarda Documentação</button>
                                        <button class="btn btn-success" ng-click="aproveLead(ic.lead)"><i class="fa fa-save"> </i> Aprovado</button>
                                        <button class="btn btn-default" style="background-color: coral; color: white " ng-click="aproveLeadAndCC(ic.lead)" title="Aprovado com pedido de Cartão de Crédito"><i class="fa fa-credit-card"> </i> Aprovado e CC</button>
                                        <button class="btn btn-default" style="background-color: #843534; color: white " ng-click="processoCC(ic.lead)" title="Cancela o processo de financiamento e cria o do CC."><i class="fa fa-credit-card"> </i> C. Crédito</button>
                                        <button class="btn btn-danger" ng-click="rejectProcess(ic.lead)"><i class="fa fa-thumbs-down"> </i> Recusado</button>
                                        <button class="btn btn-warning" onclick="window.history.back()"><i class="fa fa-undo"> </i> Voltar</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Lista da documentação -->
                <div id="rtwo.tpl" class="pnr show">
                    <div id="viewRTwo" class="">
                        <div class="panel">
                            <div class="panel-heading">
                                <h4><strong class="text-primary">{{dl.id}}</strong> - Documentação Pedida / Recebida </h4>
                            </div>
                            <div class="panel-body">
                                <table class="table table-condensed table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>Documento Pedido</th>
                                            <th>Ficheiro</th>
                                            <th>Recebido</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="d in docs">
                                            <td ng-click="verDoc(d)" class="hoverHand">{{d.nomedoc}}</td>
                                            <td ng-click="verDoc(d)" class="hoverHand">{{d.nomefx}}</td>
                                            <td ng-click="verDoc(d)" ng-if="d.recebido == 1" class="text-success hoverHand">SIM</td>
                                            <td ng-click="verDoc(d)" ng-if="d.recebido == 0" class="text-danger hoverHand">NÃO</td> 
                                            <td class="text-right">
                                                <button ng-if="d.recebido == 1 && d.nomefx" class="btn btn-success btn-sm" ng-click="verDoc(d)" title="Ver documentos"><i class="fa fa-eye"></i></button>
                                                <button ng-if="d.recebido == 1 && d.nomefx" ng-click="changeDoc(d)" class="btn btn-info btn-sm" title="Alterar a designação"><i class="fa fa-pencil-alt"></i></button>
                                                <button ng-if="d.recebido == 1 && d.nomefx" ng-click="descarregarDoc(d)" class="btn btn-primary btn-sm" title="Descarregar para pasta temporaria"><i class="fa fa-download"></i></button>
                                                <button ng-if="d.recebido == 0" ng-click="anexarDoc(d)" class="btn btn-info btn-sm" title="Anexar documento"><i class="fa fa-upload"></i></button>
                                                <button ng-if="d.recebido == 1 && d.nomefx" ng-click="removerDoc(d, dl.id)" class="btn btn-danger btn-sm" title="Remover documento"><i class="fa fa-times"></i></button>
                                                <button ng-if="d.recebido == 0" ng-click="cancelarPedidoDoc(d, dl.id)" class="btn btn-warning btn-sm" title="Cancelar pedido"><i class="fa fa-times"></i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="panel-footer text-center">
                                    <button class="btn btn-warning pull-right" ng-click="anexarDocExtra()"><i class="fa fa-upload"> </i>Documento Extra</button>
                                    <button class="btn btn-info" ng-click="pedirDoc(dl.id)"><i class="fa fa-pointer"> </i>Pedir Documentação</button>
                                    <button class="btn btn-primary" ng-click="descarregarDocs(dl.id)"><i class="fa fa-download"> </i> Descarregar Todos</button>
                                    <button ng-if="dl.status == 21 || dl.status == 22" class="btn btn-success" ng-click="docsOk(dl.id)" title="Volta a por o processo como pendente."><i class="fa fa-check"> </i> Documentação OK</button>
                                </div> 

                            </div>
                        </div>
                    </div>
                </div> 
                <!-- SIMULADOR-->
                <div id="rthree.tpl" class="pnr hide">
                    <div id="viewRThree" class="">
                        <div class="panel">
                            <div class="panel-heading">
                                <h4><strong class="text-primary">SIMULADOR </h4>
                            </div>
                            <div class="panel-body">
                                <div class="col-xs-12" style="margin-top: 7px; width: 900px">
                                    <iframe src="https://sims.cetelem.pt/sims/gestlifes-epp.html" style="max-width:450px; height:357px;" scrolling="no">
                                    </iframe>
                                    <iframe src="https://sims.cetelem.pt/sims/gestlifes-ext.html" style="max-width:450px; height:357px;" scrolling="no">
                                    </iframe> 
                                </div> 
                            </div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- Visualiza a Documentação -->
            <div ng-if="showDoc">
                <div class="panel-header bg-info">
                    <h3 class="modal-title">{{nomedoc}}
                        <span class="closeModal" ng-click="closeShowDoc()">X</span>
                    </h3>
                </div>
                <div class="panel-body">
                    <iframe ng-if="imagePath" ng-src="{{imagePath}}" width="1100px" height="800px"></iframe> 
                </div>

                <div class="panel-footer">
                    <div class="text-center">
                        <button class="btn btn-warning" ng-click="closeShowDoc()">Fechar</button>
                    </div>
                </div>
            </div>
            <br/><br/><br/><br/>

        </div>
    </div> 

</div>

<!-- Modal para fazer anexação da documentação  -->
<script type="text/ng-template" id="modalAnexarDocsA.html" ng-controller="modalInstanceAnexarDocsA"> 
    <div class="modal-header bg-info">
    <h3 class="modal-title">Anexar Documentação - LEAD: {{lead}}
    <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
    </div>

    <div class="modal-body">
    <h4>{{doc.nomedoc}}</h4>
    <form>
    <!-- <input  type="file" ng-model="file" base-sixty-four-input on-change="onChange"> -->
    <input type="file" accept="image/*, application/pdf" ng-upload-change="compressImage($event)">
    <table class="table table-bordered table-striped">
    <tr>
    <th>Ficheiro original</th>
    <th>Novo nome</th>
    <th>Tamanho (<i><small>KB</small></i>)</th>
    </tr>
    <tr>
    <td>{{file.filename}}</td>
    <td><span ng-show="file.filename">{{novonome=doc.sigla+'.'+(file.filetype).substr((file.filetype).indexOf('/')+1)}}<span></td>
    <td>{{file.filesize / 1000}}</td>
    </tr>
    <tr>
    <td colspan="2" ng-show="!file">
    <small><i>No file selected.</i></small>
    </td>
    </tr>
    </table>
    <br/>
    <div class="text-center">
    <button class="btn btn-success" ng-click="saveAttachedDoc()"><i class="fa fa-check"></i> Guardar</button>
    <button class="btn btn-warning" ng-click="closeModal()"> Cancelar</button>
    </div>
    </form>
    </div>
</script>

<!-- Modal para fazer anexação da documentação EXTRA -->
<script type="text/ng-template" id="modalAnexarDocsExtra.html" ng-controller="modalInstanceAnexarDocsExtra">  
    <div class="modal-header bg-info">
    <h3 class="modal-title">Anexar Documento - LEAD: {{lead}}
    <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
    </div>

    <div class="modal-body">
    <div class="container">
    <div class="row">
    <div class="col-xs-8">
    <form>
    <input type="file" accept="image/*, application/pdf" ng-upload-change="compressImage2($event)">

    <table class="table table-bordered table-striped">
    <tr>
    <th>Ficheiro original</th>
    <th>Novo nome</th>
    <th>Tamanho (<i><small>KB</small></i>)</th>
    </tr>
    <tr>
    <td>{{file.filename}}</td>
    <td><span ng-show="file.filename">{{novonome+'.'+(file.filetype).substr((file.filetype).indexOf('/')+1)}}<span></td>
    <td>{{file.filesize / 1000}}</td>
    </tr>
    <tr>
    <td colspan="2" ng-show="!file">
    <small><i>No file selected.</i></small>
    </td>
    </tr>
    </table>
    <br/><br/>
    <!-- Listagem dos documentos a pedir, com check box para selecionar -->
    <ul class="list-unstyled col-xs-12 col-md-6" ng-repeat="doc in docs track by doc.id">
    <li>
    <label>
    <input class="checkbox-group" type="checkbox" ng-click="upNovoNome(d)" checklist-model="d.docs" checklist-value="doc"/> 
    {{doc.nomedoc}}
    </label>
    </li>
    </ul>

    <br/><br/>
    </form>
    </div>
    </div>
    </div>
    </div>
    <div class="modal-footer">
    <div class="text-center">
    <button class="btn btn-success" ng-click="saveAttachedDocExtra()"><i class="fa fa-check"></i> Guardar</button>
    <button class="btn btn-warning" ng-click="closeModal()"> Cancelar</button>
    </div>
    </div>
</script>

<!-- Modal para alterar a designação de um documento -->
<script type="text/ng-template" id="modalChangeDoc.html" ng-controller="modalInstanceChangeDoc">  
    <div class="modal-header bg-info">
    <h3 class="modal-title">Alterar designação do Documento - LEAD: {{docOrig.lead}}
    <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
    </div>

    <div class="modal-body">
    <div class="container">
    <h4 class="text-primary"><strong>{{docOrig.nomedoc}}</strong></h4>
    <!-- Listagem dos documentos a pedir, com check box para selecionar -->
    <ul class="list-unstyled col-xs-12 col-md-6" ng-repeat="doc in docs track by doc.id">
    <li>
    <label>
    <input class="checkbox-group" type="checkbox"  checklist-model="d.docs" checklist-value="doc"/> 
    {{doc.nomedoc}}
    </label>
    </li>
    </ul>

    <br/><br/>
    </div>        
    </div>
    <div class="modal-footer">
    <div class="text-center">
    <button class="btn btn-success" ng-click="saveChange(d)"><i class="fa fa-check"></i> Guardar</button>
    <button class="btn btn-warning" ng-click="closeModal()"> Cancelar</button>
    </div>
    </div>
</script>


<!-- MODAL para rejeitar LEAD -->
<script type="text/ng-template" id="modalReject.html" ng-controller="modalInstanceReject">
    <div class="modal-header bg-info">
    <h3 class="modal-title">Registar Motivo de Rejeição
    <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
    </div>
    <div class="modal-body">
    <div class="form-inline">
    <label>Motivo: </label>
    <select class="form-control" ng-model="op.motivoTipo">
    <option value="Não reúne condições">Não reúne condições</option>
    <option value="2º Titular">Necessita 2º Titular</option>
    <option value="outro motivo a registar">Outro motivo a registar</option>
    <option value="outros">Outros</option>
    <option value="outros SEM ENVIAR EMAIL">Outros SEM ENVIAR EMAIL</option>
    </select>
    </div>
    <div class="form-group">
    <label>Outros Motivos</label>
    <textarea class="form-control" rows="5" ng-model="op.motivo"></textarea>
    </div>
    <div class="form-group">
    <label>Observações interrnas:</label>
    <textarea class="form-control" rows="5" ng-model="op.obs"></textarea>
    </div> 
    <div class="form-group">
    <label class="text-primary">Sugerir Cartão de Crédito
    <input type="checkbox" class="form-control" ng-model="op.CC" />
    </label>
    </div>   
    <div class="modal-footer text-center">
    <button class="btn btn-success" ng-click="updateRejection(op)"><i class="fa fa-save"> </i>Guarddar</button>
    <button class="btn btn-warning" ng-click="closeModal()">Cancelar</button>
    </div>
    </div>
</script>

<!-- Modal para mostrar LEADS abertas para o mesmo cliente  -->
<script type="text/ng-template" id="modalHistoric.html" ng-controller="modalInstanceHistoricAnalist">
    <div class="modal-header bg-info">
    <h3 class="modal-title">Lista de LEADS do mesmo cliente
    <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
    </div>
    <div class="modal-body">
    <table class="table table-condensed">
    <thead class="bg-primary">
    <tr>
    <th>LEAD</th>
    <th>Nome</th>
    <th>NIF</th>
    <th>Email</th>
    <th>Telefone</th>
    <th>Montante</th>
    <th>Situação</th>
    <th>Data situação</th>
    <th>Gestor</th>
    <th>Analista</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="l in lista">
    <td ng-click="openLeadDetail(l.id)"><span class="text-primary">{{l.id}}</span></td>
    <td>{{l.nome}}</td>
    <td>{{l.nif}}</td>
    <td>{{l.email}}</td>
    <td>{{l.telefone}}</td>
    <td>{{l.montante}}</td>
    <td>{{l.status}}</td>
    <td>{{l.datastatus}}</td>
    <td>{{l.usernome}}</td>
    <td>{{l.analista}}</td>
    </tr>
    </tbody>
    </table>
    </div>
    <div class="modal-footer">
    <div class="text-center">
    <button class="btn btn-warning" ng-click="closeModal()"><i class="fa fa-undo"> </i>Voltar</button>
    </div>
    </div>

</script>

<!-- Modal para Pedir Doc. Seleciona o tipo de pedido de documentação.
    Preenche a morada ou confirma o email 
    Regista a data espectavél da receção dos documentos   -->
<script type="text/ng-template" id="modalPedirDoc_.html" ng-controller="modalInstancePedirDoc_">
    <div class="modal-header bg-info">
    <h3 class="modal-title"><strong class="text-primary">{{lead}}</strong> - Documentação Necessária
    <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
    </div>

    <div class="modal-body">
    <div class="container">
    <div class="row">

    <!-- Listagem dos documentos a pedir, com check box para selecionar -->
    <div class="col-xs-12">
    <div class="col-md-5">
    <ul class="list-unstyled" ng-repeat="doc in docs1 track by doc.id | orderBy: 'doc.ordem' ">
    <li>
    <label>
    <input class="checkbox-group" type="checkbox" checklist-model="d.docs1" checklist-value="doc" />
    {{doc.nomedoc}}
    </label>
    </li>
    </ul>
    </div>
    <div class="col-md-5">
    <ul class="list-unstyled" ng-repeat="doc in docs2 track by doc.id | orderBy: 'doc.ordem' ">
    <li>
    <label>
    <input class="checkbox-group" type="checkbox" checklist-model="d.docs2" checklist-value="doc" /> 
    {{doc.nomedoc}}
    </label>
    </li>
    </ul>
    </div>                 
    </div>
    <div class="form-group col-xs-12 col-md-6">
    <br/>
    <label>Outro Documento</label>
    <input class="form-control" type='text' ng-model="outroDoc"/>
    </div>
    </div>
    </div>
    </div>
    <div class="modal-footer">
    <div class="text-center">
    <button class="btn btn-success" ng-click="enviarPedidoDoc(d)">Pedir</button>
    <a class="btn btn-warning" ng-click="closeModal()">Cancelar</a>
    </div>         
    </div>
</script>

<!-- Modal para fazer anexação da documentação  -->
<script type="text/ng-template" id="modalAnexarDocs.html" ng-controller="modalInstanceAnexarDocs"> 
    <div class="modal-header bg-info">
    <h3 class="modal-title">Anexar Documentação - LEAD: {{lead}}
    <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
    </div>

    <div class="modal-body">
    <h4>{{doc.nomedoc}}</h4>
    <form>
    <input  type="file" ng-model="file" base-sixty-four-input on-change="onChange">

    <table class="table table-bordered table-striped">
    <tr>
    <th>Ficheiro original</th>
    <th>Novo nome</th>
    <th>Tamanho (<i><small>KB</small></i>)</th>
    </tr>
    <tr>
    <td>{{file.filename}}</td>
    <td><span ng-show="file.filename">{{novonome=doc.sigla+'.'+(file.filetype).substr((file.filetype).indexOf('/')+1)}}<span></td>
    <td>{{file.filesize / 1000}}</td>
    </tr>
    <tr>
    <td colspan="2" ng-show="!file">
    <small><i>No file selected.</i></small>
    </td>
    </tr>
    </table>
    <br/>
    <div class="text-center">
    <button class="btn btn-success" ng-click="saveAttachedDoc()"><i class="fa fa-check"></i> Guardar</button>
    <button class="btn btn-warning" ng-click="closeModal()"> Cancelar</button>
    </div>
    </form>
    </div>
</script>



<!-- Modal para mostrar detalhe de uma LEAD do historico  -->
<script type="text/ng-template" id="modalHistoricoDetail.html" ng-controller="modalInstanceHistoricoDetail">
    <div class="modal-header bg-info">
    <h3 class="modal-title">Detalhe <span class="text-white">{{dl.id}} - {{dl.tipo}}</span>
    <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
    </div>
    <div class="modal-body">

    <!-- Informações sobre a LEAD -->
    <div class="panel">
    <div class="panel-heading panel-primary">
    <h4>Informação da LEAD </h4>
    </div>
    <div class="panel-body">
    <div class="col-xs-12">
    <div class="form-group-sm col-sm-2">
    <label>Fornecedor</label>
    <input type="text" class="form-control" ng-model="dl.fornecedornome" readonly=""/>
    </div>
    <div class="form-group-sm col-sm-2">
    <label>LEAD original</label>
    <input type="text" class="form-control" ng-model="dl.idleadorig" readonly=""/>
    </div>
    <div class="form-group-sm col-sm-2">
    <label>Data Entrada</label>
    <input type="text" class="form-control" ng-model="dl.dataentrada" readonly=""/>
    </div>                
    <div class="form-group-sm col-sm-2">
    <label>Situação</label>
    <input ng-click="ativar(dl)" type="text" class="form-control" ng-model="dl.nomestatus" readonly=""/>
    </div>
    <div class="form-group-sm col-sm-2">
    <label>Data Situação</label>
    <input type="text" class="form-control" ng-model="dl.datastatus" readonly=""/>
    </div>
    <div class="form-group-sm col-sm-2" ng-if="tipoUser=='Analista'">
    <label>Gestor</label>
    <input type="text" class="form-control" ng-model="dl.gestor" readonly=""/>
    </div>
    <div class="form-group-sm col-sm-2" ng-if="tipoUser=='Gestor' && dl.status>=12">
    <label>Analista</label>
    <input type="text" class="form-control" ng-model="dl.analista" readonly=""/>
    </div> 
    </div>
    <div class="col-xs-12">
    <div class="form-group-sm col-sm-2">
    <label>Origem</label>
    <input type="text" class="form-control" ng-model="dl.nomelead" readonly=""/>
    </div>                    
    <div class="form-group-sm col-sm-5">
    <label>Situação do crédito</label>
    <input type="text" class="form-control" ng-model="dl.situacao" readonly=""/>
    </div>
    <div class="form-group-sm col-sm-5">
    <label>Informações </label>
    <input type="text" class="form-control" ng-model="dl.info" readonly=""/>
    </div>                    
    </div>
    </div>
    </div>


    <!--Dados do cliente   -->
    <div class="panel">
    <div class="panel-heading panel-primary"> 
    <h4><strong class="text-primary"></strong>Informação do Cliente</h4>
    </div>
    <div class="panel-body">
    <div class="col-xs-12">
    <div class="form-group-sm col-xs-10">
    <label>Nome </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.nome" title="{{ic.nome}}"/>
    </div>
    <div class="form-group-sm col-xs-2">
    <label>Idade </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.idade"/>
    </div>
    <div class="form-group-sm col-xs-3">
    <label>Telefone </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.telefone"/>
    </div>
    <div class="form-group-sm col-xs-9">
    <label>Email </label>
    <input id="emailToCopy" ng-readonly="readOnly" class="form-control" type="text" ng-click="copyToClip()" ng-model="ic.email" title="Click para copiar"/>
    </div>
    <!-- Morada Postal -->
    <div ng-if="ic.moradarua || !readOnly">
    <div class="form-group-sm col-xs-6">
    <label class="text-info">Rua </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.moradarua"/>
    </div> 
    <div class="form-group-sm col-xs-4">
    <label class="text-info">Localidade </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.moradalocalidade"/>
    </div>                                
    <div class="form-group-sm col-xs-2">
    <label class="text-info">Codigo Postal </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.moradacp"/>
    </div> 
    </div>
    <div class="form-group-sm col-xs-3">
    <label>NIF </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.nif"/>
    </div>
    <div class="form-group-sm col-sm-2">
    <label>IRS</label>
    <input type="text" class="form-control" ng-model="ic.irs"  ng-readonly="readOnly"/>
    </div>                                
    <div class="form-group-sm col-xs-3">
    <label>Estado Civil </label>
    <select readonly disabled="" class="form-control" ng-model="ic.estadocivil">
    <option ng-repeat="ec in estadoscivis" ng-value="ec.id" ng-selected="ic.estadocivil==ec.id">{{ec.nome}}</option>
    </select>
    </div>
    <div class="form-group-sm col-xs-2">
    <label>Filhos </label>
    <input ng-readonly="readOnly" class="form-control" type="text"  ng-model="ic.filhos"/>
    </div>
    <div class="form-group-sm col-xs-4">
    <label>Profissão </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.profissao"/>
    </div>                                
    <div class="form-group-sm col-xs-4">
    <label>Tipo contrato </label>
    <input readonly class="form-control" type="text" ng-model="ic.nomecontrato"/>
    </div>
    <div class="form-group-sm col-xs-2">
    <label>Inicio </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.anoinicio"/>
    </div>                                
    <div class="form-group-sm col-xs-2">
    <label>Vencimento </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.vencimento"/>
    </div>                                
    </div>
    <!-- Habitação -->
    <div class="col-xs-12">
    <div class="form-group-sm col-sm-4">
    <label>Habitação</label>
    <input type="text" class="form-control" ng-model="ic.nomehabitacao" ng-readonly="true"/>
    </div>
    <div class="form-group-sm col-sm-2" ng-if="ic.valorhabitacao>0">
    <label>Renda/Prestação</label>
    <input type="text" class="form-control"  ng-model="ic.valorhabitacao" ng-readonly="true"/>
    </div>
    <div class="form-group-sm col-sm-2">
    <label>Inicio</label>
    <input type="text" class="form-control" ng-model="ic.anoiniciohabitacao" ng-readonly="readOnly"/>
    </div>                 
    <div class="form-group-sm col-sm-2" ng-if="ic.declarada">
    <label>Declarada</label>
    <input type="text" class="form-control" ng-model="ic.declarada" ng-readonly="readOnly"/>
    </div>
    <div class="form-group-sm col-sm-2" ng-if="ic.mesmahabitacao">
    <label class="text-info">Mesma</label>
    <input type="text" class="form-control" ng-model="ic.mesmahabitacao" ng-readonly="readOnly"/>
    </div>
    <div ng-if="ic.mesmahabitacao=='Não'">
    <div class="form-group-sm col-sm-4">
    <label class="text-info">Habitação 2º</label>
    <input type="text" class="form-control" ng-model="ic.nomehabitacao2" ng-readonly="true"/>
    </div>
    <div class="form-group-sm col-sm-2" ng-if="ic.valorhabitacao2>0">
    <label class="text-info">Renda/Prestação</label>
    <input type="text" class="form-control"  ng-model="ic.valorhabitacao2" ng-readonly="readOnly"/>
    </div>
    <div class="form-group-sm col-sm-2">
    <label class="text-info">Inicio</label>
    <input type="text" class="form-control" ng-model="ic.anoiniciohabitacao2" ng-readonly="readOnly"/>
    </div>                 
    <div class="form-group-sm col-sm-2" ng-if="ic.declarada2">
    <label class="text-info">Declarada</label>
    <input type="text" class="form-control" ng-model="ic.declarada2" ng-readonly="readOnly"/>
    </div> 
    </div>
    </div>
    <div class="col-xs-12">
    <div class="form-group-sm col-xs-2">
    <label class="text-info">Parentesco </label>
    <input readonly class="form-control" type="text" ng-model="ic.parentesco2"/>
    </div>                                
    <div class="form-group-sm col-xs-2">
    <label class="text-info">Idade 2º Prop. </label>
    <input readonly class="form-control" type="text" ng-model="ic.idade2"/>
    </div>
    <div class="form-group-sm col-xs-3">
    <label class="text-info">Telefone </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.telefone2"/>
    </div>
    <div class="form-group-sm col-xs-3">
    <label class="text-info">NIF </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.nif2"/>
    </div>
    <div class="form-group-sm col-xs-4">
    <label class="text-info">Profissão </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.profissao2"/>
    </div>                                
    <div class="form-group-sm col-xs-4">
    <label class="text-info">Tipo contrato </label>
    <input readonly class="form-control" type="text" ng-model="ic.nomecontrato2"/>
    </div> 
    <div class="form-group-sm col-xs-2">
    <label class="text-info">Inicio </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.anoinicio2"/>
    </div>                                
    <div class="form-group-sm col-xs-2">
    <label class="text-info">Vencimento </label>
    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.vencimento2"/>
    </div>
    <div class="form-group-sm col-xs-12">
    <label>Outras Informações:</label>
    <textarea class="form-control" ng-readonly="readOnly" ng-model="ic.outrainfo"></textarea>
    </div>
    <div  ng-if="historic.length>0"  class="form-group-sm col-xs-2">
    <label class="text-info">Ver </label>
    <button class="btn btn-warning btn-sm" ng-click="showHistorico(historic)">Histórico</button>
    </div> 

    </div>
    </div>
    </div>     

    <!--  Credito Pretendido/Rendimentos/Despesas  -->        
    <div class="panel">
    <div class="panel-heading panel-primary">
    <h4><strong class="text-primary"></strong>Crédito Pretendido</h4>
    </div>
    <div class="panel-body">
    <div class="col-xs-12">
    <div class="form-group-sm col-xs-2">
    <label for="montante">Valor Pretendido</label>
    <input id="montante" name="montante" string-to-number  class="form-control no-spinner" min="0" type="number" ng-model="ic.valorpretendido" ng-readonly="readOnly"/>
    </div>
    <div class="form-group-sm col-xs-2">
    <label for="tipoLead">Tipo Crédito</label>                
    <select id="tipoLead" class="form-control" ng-model="ic.tipocredito" ng-readonly="readOnly">
    <option value="CP" ng-selected="ic.tipocredito=='CP'">CP</option>
    <option value="CC" ng-selected="ic.tipocredito=='CC'">CC</option>
    <option value="AU" ng-selected="ic.tipocredito=='AU'">Auto</option>
    </select>
    </div>                
    <div class="form-group-sm col-xs-2">
    <label for="numprestacoes">Prazo </label>
    <input id="numprestacoes" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="ic.prazopretendido" ng-readonly="readOnly"/>
    </div>
    <div class="form-group-sm col-xs-2">
    <label for="valorprestacao">Prestação </label>
    <input id="valorprestacao" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="ic.prestacaopretendida"  ng-readonly="readOnly"/>
    </div>
    <div class="form-group-sm col-xs-4">
    <label for="finalidade">Finalidade</label>
    <input id="finalidade" name="finalidade" class="form-control" type="text" ng-model="ic.finalidade"  ng-readonly="readOnly"/>
    </div>
    </div>
    <div class="col-xs-8 col-xs-offset-2">
    <br/>
    <table class="table table-condensed" ng-show="rendimentos!=''">
    <thead>
    <tr>
    <th colspan="3" class="text-center">Outros Rendimentos</th>
    </tr>
    <tr>
    <th>Tipo de rendimento</th>
    <th>Valor</th>
    <th>Periocidade</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="r in rendimentos">
    <td class="text-white">{{r.tiporendimento}}</td>
    <td class="text-white">{{r.valorrendimento}}€</td>
    <td class="text-white">{{r.periocidade}}</td>
    </tr>
    </tbody>
    </table>
    <!-- Outros Creditos -->
    <br/>
    <table class="table table-condensed" ng-show="creditos!=''">
    <thead>
    <tr>
    <th colspan="3" class="text-center">Outros Créditos</th>
    </tr>                        
    <tr>
    <th>Tipo de Crédito</th>
    <th>Valor Crédito</th>
    <th>Prestação</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="c in creditos">
    <td class="text-white">{{c.tipocredito}}</td>
    <td class="text-white">{{c.valorcredito}}€</td>
    <td class="text-white">{{c.prestacao}}€</td>
    </tr>
    </tbody>
    </table>   
    </div>
    </div>
    </div>

    <!-- Documentos pedidos e recebidos -->
    <div class="panel">
    <div class="panel-heading">
    <h4><strong class="text-primary"></strong>Documentação Pedida / Recebida </h4>
    </div>
    <div class="panel-body">
    <table class="table table-condensed table-striped table-hover">
    <thead>
    <tr>
    <th>Documento Pedido</th>
    <th>Ficheiro</th>
    <th>Recebido</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="d in docs">
    <td>{{d.nomedoc}}</td>
    <td>{{d.nomefx}}</td>
    <td ng-if="d.recebido==1" class="text-success">SIM</td>
    <td ng-if="d.recebido==0" class="text-danger">NÃO</td> 
    </tr>
    </tbody>
    </table>
    </div>
    </div>

    <!-- Registo de contactos -->

    <div class="panel">
    <div class="panel-heading panel-primary">
    <h4><strong class="text-primary"></strong>Contactos</h4>
    </div>
    <div class="panel-body">
    <table class="table table-condensed" ng-show="contactos!=''">
    <thead>
    <tr>
    <th colspan="3" class="text-center">Historico de Contactos</th>
    </tr>
    <tr>
    <th>Data</th>
    <th>Motivo</th>
    <th>Gestor</th>
    <th>Analista</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="c in contactos">
    <td>{{c.data}}</td>
    <td>{{c.descricao}}</td>
    <td>{{c.gestor}}</td>
    <td>{{c.analista}}</td>
    </tr>
    </tbody>
    </table>  
    </div>
    </div>

    <!-- Financiamentos -->
    <div class="panel">
    <div class="panel-heading panel-primary">
    <h4><strong class="text-primary"></strong>Financiamentos</h4>
    </div>
    <div class="panel-body">
    <div class="form-group-sm col-xs-12">
    <!-- Registo dos financiamentos -->
    <table class="table table-condensed" ng-show="financiamentos!=''">
    <thead>
    <tr>
    <th colspan="10" class="text-center">Registo dos Pedidos de Financiamento</th>
    </tr>                        
    <tr>
    <th>Processo</th>
    <th>Parceiro</th>
    <th>Montante</th>
    <th>Prazo</th>
    <th>Prestação</th>
    <th>Contrato Cliente -></th>
    <th>Meio</th>
    <th>Contrato Parceiro</th>
    <th>Data</th>
    <th>Status</th>
    </tr>
    </thead>
    <tbody>
    <tr ng-repeat="f in financiamentos">
    <td>{{f.processo}}</td>
    <td>{{f.nome}}</td>
    <td>{{f.montante}}</td>
    <td>{{f.prazo}}</td>
    <td>{{f.prestacao}}</td>
    <td>{{f.dtcontratocliente}}</td>
    <td>{{f.formaenvio}}</td>
    <td>{{f.dtcontratoparceiro}}</td>
    <td>{{f.datastatus}}</td>
    <td>{{f.statusnome}}</td>
    <td ng-if="f.outrainfo">{{f.outrainfo}}"></td>
    </tr>
    </tbody>
    </table>
    </div>                            
    </div>
    </div>

    <!-- Informações e Rejeições -->
    <div class="panel">
    <div class="panel-heading panel-primary">
    <h4><strong class="text-primary"></strong>Informações</h4>
    </div>
    <div class="panel-body">
    <div class="form-group-sm col-xs-12">
    <label>Rejeições:</label>
    <textarea rows="5" class="form-control" ng-readonly="readOnly || tipoUser=='Gestor'" ng-model="rejeicoes"></textarea>
    </div>                            
    </div>
    <div class="panel-body">
    <div class="form-group-sm col-xs-12">
    <label>Outras Informações:</label>
    <textarea rows="5" class="form-control" ng-readonly="readOnly || tipoUser=='Analista'" ng-model="ic.outrainfo"></textarea>
    </div>                            
    </div>                        
    </div>

    <!-- Notas e Observações do Analista-->
    <div class="panel">
    <div class="panel-heading panel-primary">
    <h4><strong class="text-primary"></strong>Notas</h4>
    </div>
    <div class="panel-body">
    <div class="form-group-sm col-xs-12">
    <label>Notas:</label>
    <textarea rows="6" class="form-control" ng-model="ic.nota" ng-readonly="readOnly || tipoUser=='Gestor'"></textarea>
    </div>                            
    </div>
    </div> 
    </div>
</script>


<!-- Modal para associar Simulação a Parceiro  
<script type="text/ng-template" id="modalSaveSimula.html" ng-controller="modalInstanceSaveSimula">
    <div class="modal-header bg-info">
        <h3 class="modal-title">Associar Simulação a Parceiro
            <span class="closeModal" ng-click="closeModal()">X</span>
        </h3>
    </div>
    <div>
        <table class="table table-condensed table-hover" style="width:80%; margin:auto">
            <thead>
                <tr>
                    <th>&nbsp;</th>
                    <th>Parceiro</th>
                    <th>Processo</th>
                    <th>Tipo</th>
                    <th>Valor</th>
                    <th>Prestaçao</th>
                    <th>Prazo</th>                            
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="p in parceiros track by $index" >
                    <td>
                        <input type="radio" class="form-control" name="parceiro"  ng-model="$parent.parceiro" ng-value="p" />
                    </td>
                    <td>{{p.nome}}</td>
                    <td>{{p.processo}}</td>                        
                    <td>{{p.tipocredito}}</td>
                    <td>{{p.montante}}</td>
                    <td>{{p.prestacao}}</td>
                    <td>{{p.prazo}}</td>
                </tr>
                <tr>
                    <td>
                        <input class="form-control"  type="radio" name="parceiro" value="0" ng-model="parceiro">
                    </td> 
                    <td>Nenhum</td>
                    <td colspan="5">&nbsp;</td>
                </tr>
            </tbody>
        </table>

        <br/>
        <div class="text-center">
            <button class="btn btn-success" ng-click="saveSimula(parceiro)"><i class="fa fa-check"></i> Guardar</button>
            <button class="btn btn-warning" ng-click="closeModal()"> Cancelar</button>
        </div>
    </div>
</script> -->

<!-- Modal para listar Simulações guardadas -->
<script type="text/ng-template" id="modalGetSimula.html" ng-controller="modalInstanceGetSimula"> 
        <div class="modal-header bg-info">
            <h3 class="modal-title">Simulações Guardadas
                 <span class="closeModal" ng-click="closeModal()">X</span>
            </h3>
        </div>
        <div>
            <table class="table table-condensed table-hover" style="width:80%; margin:auto">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Tipo</th>
                        <th>Valor</th>
                        <th>Prestaçao</th>
                        <th>Prazo</th>
                        <th>2 ª Titular</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="s in simulacoes" ng-click="selectSimula(s)">
                        <th>{{s.linha}}</th>
                        <td>{{s.tipocredito}}</td>
                        <td>{{s.valorpretendido}}</td>
                        <td>{{s.prestacaopretendida}}</td>
                        <td>{{s.prazopretendido}}</td>
                        <td ng-if="s.segundoproponente==1">Sim</td>
                        <td ng-if="s.segundoproponente==0">Não</td>
                    </tr>
                </tbody>
            </table>

            <br/>
            <div class="text-center">
                <button class="btn btn-warning" ng-click="closeModal()"> Cancelar</button>
            </div>
        </div>
</script>
