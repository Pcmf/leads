<!DOCTYPE html>
<!--
    Show list of actual users and a form to edit or create news
-->
<div class="container-fluid" id="total">
    <div class="row">
        <!-- informações da lead -->
        <div id="leadInfo" class="col-md-3"  style="padding-left: 20px; height:16px" >
            
            <h3 class="text-center">Dados da LEAD 
                <span class="label label-default">{{lead.id}}</span>
                <span class="label label-primary pull-right">{{lead.statusnome}}</span>
            </h3>
            <div class="col-xs-12">
                <div class="form-group-sm col-xs-5">
                    <label>Data de entrada </label>
                    <input class="form-control" type="text" ng-model="lead.dataentrada" readonly=""/>
                </div>
                <div class="form-group-sm col-xs-3">
                    <label>Tipo Crédito </label>
                    <input class="form-control" type="text" ng-model="lead.tipo" readonly=""/>
                </div> 
                <div class="form-group-sm col-xs-4">
                    <label>ID Original</label>
                    <input class="form-control" type="text" ng-model="lead.idleadorig" readonly title="Id original da LEAD"/>
                </div>                
            </div>
            <div class="col-xs-12"  ng-class="{'bg-red': lead.nomeFornecedor=='BPS-Docs' || lead.nomeFornecedor=='BPS-Premium-Docs'}">
                <div class="form-group-sm col-xs-6">
                    <label>Fornecedor</label>
                    <input  class="form-control" type="text" ng-model="lead.nomeFornecedor" title="{{lead.nomeFornecedor}}" readonly/>
                </div>
                <div class="form-group-sm col-xs-6">
                    <label>Origem</label>
                    <input class="form-control" type="text" ng-model="lead.nomelead" readonly title="{{lead.nomelead}}"/>
                </div>
            </div>
            <div class="col-xs-12">
                <div class="form-group-sm" ng-if="lead.info">
                    <label>Outras Informações </label>
                    <textarea class="form-control" rows="2" readonly>{{lead.info}}</textarea>
                </div> 
                
                    <div class="form-group-sm" ng-if="lead.situacao">
                        <textarea class="form-control" rows="2" readonly>{{lead.situacao}}</textarea>
                    </div> 
            </div> 

            <div class="col-xs-12" ng-if="openLeads.length">
                <br/>
                <button class="btn btn-warning btn-block" ng-click="listOpenLeads(openLeads)">
                    Ver HISTORICO e LEADS em aberto ({{openLeads.length}})
                </button>
            </div>

                <div class="col-xs-12" style="margin-top: 7px; width: 450px">
                        <iframe ng-if="tpc=='CC'" src="https://sims.cetelem.pt/sims/gestlifes-ext.html" style="max-width:450px; height:354px;" scrolling="no">
                        </iframe>
                        <iframe  ng-if="tpc=='CP' || tpc=='AU'" src="https://sims.cetelem.pt/sims/gestlifes-epp.html" style="max-width:450px; height:354px;"  scrolling="no">
                        </iframe>
                </div> 
            <!-- dados de histórico de contacto -->
            <div class="col-xs-12">
                <h4 class="">Historico</h4>
                <div style="max-height: 260px; overflow-y: scroll">
                <ul class="list-unstyled" ng-repeat="r in regCont">
                    <li title="{{r.descricao}}">{{r.dtcontacto}} --- {{r.motivo}}</li>
                </ul>
                </div>
            </div>
                
            
        </div> 
        
        <!-- Painel do formulario de contacto -->
        <div id="formProcess" class="col-md-8" style="border-left: #269abc groove medium;">
            <div class="col-xs-12">
                <div class="col-xs-2">
                    <button ng-if="c.mkCall" class="btn btn-success btn-lg" ng-click="makeCall()"><i class="fa fa-phone"> Ligar</i></button>
                    <button ng-if="!c.mkCall" class="btn btn-danger btn-lg" ng-click="makeCall()"><i class="fa fa-phone-volume"> Desligar</i></button>
                </div>
                <div class="col-xs-3">
                    <h3 class="text-primary">Formulário de contacto</h3>
                </div>
                <div class="col-xs-7">
                    <span class="pull-right">
                        <button class="btn btn-danger btn-sm" ng-click="notAtrib()" ng-disabled="lead.status==6 || lead.status==7">
                            <i class="fa fa-phone-slash"> </i> Não Atribuido
                        </button>
                        <button class="btn btn-warning btn-sm" ng-click="noAnswer()">
                            <i class="glyphicon glyphicon-phone-alt"> </i> Desligado/Não Atende
                        </button>
                        <button class="btn btn-info btn-sm" ng-click="agendamento()">
                            <i class="fa fa-calendar-alt"> </i> Agendamento
                        </button>
                        <button class="btn btn-default btn-sm" ng-click="foraDoExpediente()">
                            <i class="fa fa-clock-o"> </i> Fora do Expediente
                        </button>  
                        <button class="btn btn-primary btn-sm" ng-click="agendamentoBP()">
                            <i class="fa fa-calendar-alt"> </i> Ag. BP
                        </button>                        
                    </span>
                </div>
            </div>
            <!-- Formulario para registo do contacto -->
            <form ng-submit="finalize(c)">
            <div class="col-xs-12">
                <div class="form-group-sm col-xs-4">
                    <label for="nome">Nome </label>
                    <input id="nome" name="nome" class="form-control" type="text" ng-model="c.nome" required=""/>
                </div>
                <div class="form-group-sm col-xs-1">
                    <label for="idade">Idade </label>
                    <input id="idade" name="idade" class="form-control no-spinner" min="18" max="99" type="number" ng-model="c.idade" string-to-number required=""/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label for="telefone">Telefone </label>
                    <input id="telefone" name="telefone" class="form-control no-spinner" string-to-number min="210000000" max="999999999" type="number" ng-model="c.telefone" required=""/>
                </div>
                <div class="form-group-sm col-xs-3">
                    <label for="email">Email </label>
                    <input id="email" class="form-control" type="text"  ng-model="c.email" required=""/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label for="nif">NIF </label>
                    <input id="nif" name="nif" class="form-control no-spinner" string-to-number  type="number" min="100000000" max="999999999"  ng-model="c.nif" required=""/>
                </div>                
            </div>

        <!-- Situação familiar -->
            <div class="col-xs-12">
                <div class="form-group-sm col-xs-3">
                    <label>Estado Civil </label>
                    <select class="form-control" ng-model="c.estadocivil"  required="">
                        <option ng-repeat="ec in estadoscivis track by ec.id" ng-selected="c.estadocivil==ec.id" ng-value="ec.id">{{ec.nome}}</option>
                    </select>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label class="control-label">IRS </label>
                    <select class="form-control" ng-model="c.irs" required="">
                        <option ng-value="">  </option>
                        <option ng-selected="c.irs=='Sim'" ng-value="'Sim'">Sim</option>
                        <option  ng-selected="c.irs=='Sim junto'" ng-value="'Sim junto'">Sim, junto</option>
                        <option  ng-selected="c.irs=='Sim separado'" ng-value="'Sim separado'">Sim, separado</option>
                        <option ng-selected="c.irs=='Nao'" ng-value="'Nao'">Não</option>
                    </select>
                </div>
                <div class="form-group-sm col-xs-1">
                    <label for="filhos">Filhos </label>
                    <input id="filhos" class="form-control no-spinner" string-to-number  min="0" max="10" type="number" ng-model="c.filhos"/>
                </div>
                <div class="form-group-sm col-xs-3">
                    <label for="segprop">Segundo proponente
                        <input id="segprop" class="form-control" type="checkbox" ng-model="c.segprop" ng-change="segundoProponente()"></label>
                </div>
            </div>  
            <!-- Segundo Proponente  -->
            <div class="form-group-sm col-xs-12" ng-show="c.segprop">
                <fieldset style="border: 1px #9acfea outset">
                    <div class="col-xs-12">
                        <div class="form-inline-sm col-xs-3">
                            <label>Conjugue
                                <input class="form-control" name="parent" type="radio" ng-model="grauparent" value="Conjugue">
                            </label>
                            <label>Outro
                                <input class="form-control" name="parent" type="radio" ng-model="grauparent" value="Outro">
                            </label>
                        </div>
                        <div class="form-inline-sm col-xs-7" ng-if="grauparent=='Outro'">
                            <label>Qual?</label>
                            <input type="text" class="form-control" ng-model="c.parentesco2"/>
                        </div>
                    </div> 
                    <div class="col-xs-12">    
                        <div class="form-group-sm col-xs-1">
                            <label for="idade2">Idade<small class="text-danger"> *</small> </label>
                            <input id="idade2" class="form-control no-spinner" string-to-number  min="18" max="99" type="number" ng-model="c.idade2"/>
                        </div>                    
                        <div class="form-group-sm col-xs-3">
                            <label for="profissao2">Setor do 2º proponente<small class="text-danger"> *</small> </label>
                            <select id="profissao2" class="form-control" ng-model="c.profissao2">
                               <option value="Privado">Privado</option>
                              <option value="Publico">Publico</option>                                
                            </select>
                        </div>
                        <div class="form-group-sm col-xs-2">
                            <label>Tipo Contrato<small class="text-danger"> *</small> </label>                        
                            <select class="form-control" ng-model="c.tipocontrato2" required="">
                                <option ng-repeat="tc2 in tipocontratos track by tc2.id" ng-value="tc2.id" ng-selected="c.tipocontrato2==tc2.id">{{tc2.nome}}</option>
                            </select>                         
                        </div>
                        <div class="form-group-sm col-xs-2">
                            <label for="vencimento2">Vencimento<small class="text-danger"> *</small> </label>
                            <input id="vencimento2" class="form-control no-spinner" string-to-number  minlength="3" type="number" ng-model="c.vencimento2" ng-change="showTx()"/>
                        </div>
                        <div class="form-group-sm col-xs-2">
                            <label>Mês inicio</label>
                            <select class="form-control" ng-model="c.mesinicio2">
                                <option value="1" ng-selected="c.mesinicio2==1">Janeiro</option>
                                <option value="2" ng-selected="c.mesinicio2==2">Fevereiro</option>
                                <option value="3" ng-selected="c.mesinicio2==3">Março</option>
                                <option value="4" ng-selected="c.mesinicio2==4">Abril</option>
                                <option value="5" ng-selected="c.mesinicio2==5">Maio</option>
                                <option value="6" ng-selected="c.mesinicio2==6">Junho</option>
                                <option value="7" ng-selected="c.mesinicio2==7">Julho</option>
                                <option value="8" ng-selected="c.mesinicio2==8">Agosto</option>
                                <option value="9" ng-selected="c.mesinicio2==9">Setembro</option>
                                <option value="10" ng-selected="c.mesinicio2==10">Outubro</option>
                                <option value="11" ng-selected="c.mesinicio2==11">Novembro</option>
                                <option value="12" ng-selected="c.mesinicio2==12">Dezembro</option>
                            </select>
                        </div>                        
                        <div class="form-group-sm col-xs-2">
                            <label for="anoini2">Ano inicio<small class="text-danger"> *</small> </label>
                            <input id="anoini2" class="form-control no-spinner" string-to-number  type="number" min="1940" max="{{anoatual}}" ng-model="c.anoinicio2"/>
                        </div>
                    </div>
                    <div class="col-xs-12">
                        <div class="form-group-sm col-xs-2">
                            <label for="telefone2">Telefone</label>
                            <input id="telefone" class="form-control no-spinner" string-to-number minlength="9" type="number" ng-model="c.telefone2" />
                        </div>
                        <div class="form-group-sm col-xs-2">
                            <label for="nif2">NIF</label>
                            <input id="nif2" class="form-control no-spinner"  type="number" ng-model="c.nif2"/>
                        </div>
                        <div class="form-group-sm col-xs-6">
                            <label>Habitação do 2º Proponente</label>
                            <select class="form-control" ng-model="c.mesmahabitacao">
                                <option ng-selected="c.mesmahabitacao=='Sim'" ng-value="'Sim'">Mesma do primeiro</option>
                                <option ng-selected="c.mesmahabitacao=='Não'" ng-value="'Não'">Outra</option>
                            </select>
                        </div>
                    </div> 
                    <div class="col-xs-12" ng-if="c.mesmahabitacao=='Não'">
                            <div class="form-group-sm col-xs-3">
                                <label>Habitação 2ª<small class="text-danger"> *</small></label>
                                <select class="form-control" ng-model="c.tipohabitacao2"  required="">
                                    <option ng-repeat="th in tiposhabitacao track by th.id" ng-selected='c.tipohabitacao2==th.id' ng-value="th.id">{{th.nome}}</option>
                                </select>
                            </div>
                            <div ng-if="c.tipohabitacao2 ==1">
                                <div class="form-group-sm col-xs-2">
                                    <label>Renda </label>
                                    <input class="form-control no-spinner" min="0" type="number" ng-model="c.valorhabitacao2" required=""/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Declarada</label>
                                    <label>
                                        <input class="" name="declarada" type="radio" ng-model="c.declarada2" value="Sim"/>
                                        Sim
                                    </label>
                                    <label>
                                        <input class="" name="declarada"  type="radio" ng-model="c.declarada2" value="Não"/>
                                        Não
                                    </label>
                                </div>
                            </div>
                            <div ng-if="c.tipohabitacao2 ==3">
                                <div class="form-group-sm col-xs-2">
                                    <label for="prestacao">Prestação </label>
                                    <input id="prestacao" name="prestacao" class="form-control no-spinner" min="1" type="number" ng-model="c.valorhabitacao2"/>
                                </div>
                            </div>                
                            <div class="form-group-sm col-xs-2">
                                <label for="desde">Desde<small class="text-danger"> *</small></label>
                                <input id="desde" name="anoiniciohabitacao2" class="form-control no-spinner" min="1940" max="{{anoatual}}" type="number" ng-model="c.anoiniciohabitacao2" required=""/>
                            </div>
                    </div>
                </fieldset>
            </div>
        <!-- Habitação -->
            <div class="col-xs-12">
                <div class="form-group-sm col-xs-3">
                    <label>Habitação </label>
                    <select class="form-control" ng-model="c.tipohabitacao" required="">
                        <option ng-repeat="th in tiposhabitacao track by th.id" ng-selected="c.tipohabitacao==th.id" ng-value="th.id">{{th.nome}}</option>
                    </select>
                </div>
                <div ng-if="c.tipohabitacao ==1"> <!--Alugada-->
                    <div class="form-group-sm col-xs-2">
                        <label>Renda </label>
                        <input class="form-control no-spinner"  string-to-number min="0" type="number" ng-model="c.valorhabitacao" required=""/>
                    </div>
                    <div class="form-group-sm col-xs-2">
                        <label>Declarada</label>
                        <label>
                            <input class="" name="declarada" type="radio" ng-model="c.declarada" value="Sim" />
                            Sim
                        </label>
                        <label>
                            <input class="" name="declarada"  type="radio" ng-model="c.declarada" value="Não"/>
                            Não
                        </label>
                    </div>
                </div>
                <div ng-if="c.tipohabitacao ==3"> <!--Propria co CH-->
                    <div class="form-group-sm col-xs-2">
                        <label for="prestacao">Prestação </label>
                        <input id="prestacao" name="prestacao" class="form-control no-spinner" min="0" type="number" ng-model="c.valorhabitacao"/>
                    </div>
                </div>                
                <div class="form-group-sm col-xs-2">
                    <label>Desde </label>
                    <input class="form-control no-spinner" string-to-number  type="number" min="1940" max="{{anoatual}}" ng-model="c.anoiniciohabitacao" required=""/>
                </div>
            </div>
        <!-- Situação profissional -->
            <div class="col-xs-12">
                <div class="form-group-sm col-xs-3">
                    <label>Tipo Contrato </label>
            <select class="form-control" ng-model="c.tipocontrato" required="">
                <option ng-repeat="tc in tipocontratos track by tc.id" ng-value="tc.id" ng-selected="c.tipocontrato==tc.id">{{tc.nome}}</option>
            </select>   
           
                </div>
                <div class="form-group-sm col-xs-2">
                    <label for="vencimento">Vencimento </label>
                    <input id="vencimento" name="vencimento" class="form-control no-spinner" string-to-number  type="number" minlength="3" ng-model="c.vencimento" 
                          required=""/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label>Mês inicio</label>
                    <select class="form-control" ng-model="c.mesinicio" required="">
                        <option value="1">Janeiro</option>
                        <option value="2">Fevereiro</option>
                        <option value="3">Março</option>
                        <option value="4">Abril</option>
                        <option value="5">Maio</option>
                        <option value="6">Junho</option>
                        <option value="7" >Julho</option>
                        <option value="8">Agosto</option>
                        <option value="9" >Setembro</option>
                        <option value="10">Outubro</option>
                        <option value="11" >Novembro</option>
                        <option value="12" >Dezembro</option>
                    </select>
                </div>
                <div class="form-group-sm col-xs-1">
                    <label for="anoini"> Ano Inicio </label>
                    <input id="anoini" name="anoini" class="form-control no-spinner" string-to-number  type="number" min="1940" max="{{anoatual}}" ng-model="c.anoinicio" required=""/>
                </div> 
                <div class="form-group-sm col-xs-2">
                    <label for="profissao">Setor </label>
                    <select id="profissao" name="profissao" class="form-control" ng-model="c.profissao">
                        <option value="Privado">Privado</option>
                        <option value="Publico">Publico</option>
                    </select>
                </div>
            </div>        
        <!-- Outros Rendimentos  -->
            <div class="col-xs-12" ng-repeat="or in outrosR track by $index">
                <div class="form-group-sm col-xs-4">
                    <label ng-if="$index==0">Outros Rendimentos </label>
                    <input class="form-control" type="text" ng-model="c.or[$index].tiporendimento"/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label ng-if="$index==0">Valor </label>
                    <input class="form-control no-spinner" type="number" string-to-number  ng-model="c.or[$index].valorrendimento"/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label ng-if="$index==0">Periocidade </label>
                    <select class="form-control" name="periocidade" type="number" ng-model="c.or[$index].periocidade">
                        <option value="Mes">Mensal</option>
                        <option value="Ano">Anual</option>
                    </select> 
                </div>
                <div class="form-group-sm col-xs-1">
                    <label ng-if="$index==0">&nbsp;</label>
                    <a ng-if="$index==0" class="btn btn-sm" title="Adicionar uma linha" ng-click="addLineOutrosRendimentos()"><i class="fa fa-plus-circle"></i></a>
                    <a ng-if="$index>0" class="btn btn-sm" title="Remover linha" ng-click="removeLineOutrosRendimentos()"><i class="fa fa-minus-circle text-danger"></i></a>
                </div>
            </div>
            <!-- Outros Créditos -->
            <div class="col-xs-12" ng-repeat="oc in outrosC track by $index">
                <div class="form-group-sm col-xs-4">
                    <label ng-if="$index==0">Outros Créditos </label>
                    <input class="form-control" type="text" ng-model="c.oc[$index].tipocredito"/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label ng-if="$index==0">Valor </label>
                    <input class="form-control no-spinner" min="0" string-to-number  type="number" ng-model="c.oc[$index].valorcredito"/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label ng-if="$index==0">Prestação </label>
                    <input class="form-control no-spinner" min="0" string-to-number  type="number" ng-model="c.oc[$index].prestacao"/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label  ng-if="$index==0">Liquidar</label>
         <!--        <input type="checkbox" class="form-control"  ng-model="c.oc[$index].liquidar" ng-name="oc[$index]"/>  -->
         <select class="form-control" ng-model="c.oc[$index].liquidar" required=""  ng-change="calcularPoupanca()">
             <option ng-value="1">SIM</option>
             <option ng-value="0">NÃO</option>
         </select>
                </div>
                <div class="form-group-sm col-xs-1">
                    <label ng-if="$index==0">&nbsp;</label>
                    <a ng-if="$index==0" class="btn btn-sm" title="Adicionar uma linha" ng-click="addLineOutrosCreditos()"><i class="fa fa-plus-circle"></i></a>
                    <a ng-if="$index>0" class="btn btn-sm" title="Remover linha" ng-click="removeLineOutrosCreditos($index)"><i class="fa fa-minus-circle text-danger"></i></a>
                </div>
            </div>
            <!-- Informação sobre o total dos credidtos e das prestações -->
            <div class="col-xs-12" ng-if="c.tipocredito=='CC'">
                     <div class="form-group-sm col-xs-3">
                            <label for="totalOCreditos">Total Creditos</label>
                            <input id="totalOCreditos" name="totalOCreditos" class="form-control" type="text" ng-model="totalOCreditos" readonly=""/>
                      </div>  
                      <div class="form-group-sm col-xs-3">
                            <label for="totalOCPrestacoes">Total prestações</label>
                            <input id="totalOCPrestacoes" name="totalOCPrestacoes" class="form-control" type="text" ng-model="totalOCPrestacoes" readonly=""/>
                      </div>
                      <div class="form-group-sm col-xs-1">
                            <label>&nbsp;</label>
                            <button type="button" class="btn btn-sm btn-info" ng-click="calcularPoupanca()"><i class="fa fa-refresh"></i></button>
                      </div>
            </div>
            <!-- informações sobre o crédito pretendido -->
            <div class="col-xs-12">
                 <div class="form-group-sm col-xs-2">
                    <label for="montante">V. Pretendido</label>
                    <input id="montante" name="montante" string-to-number  class="form-control no-spinner" min="0" type="number" ng-model="c.montante" required=""/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label for="tipoLead">Tipo Crédito</label>                
                    <select id="tipoLead" class="form-control" ng-model="c.tipocredito" required="" ng-change="changeTPC()">
                        <option value="CP" >Pessoal</option>
                        <option value="CC" >Consolidado</option>
                        <option value="CT" >Cartão de Crédito</option>
                        <option value="AU" >Auto</option>
                        <option value="CHCC" >Consolidado com CH</option>
                        <option value="CH1" >CH 1ª Hipoteca</option>
                        <option value="CH2" >CH 2ª Hipoteca</option>
                    </select>
                </div>     
                  
                <div class="form-group-sm col-xs-1">
                    <label for="numprestacoes">Prazo </label>
                    <input id="numprestacoes" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="c.prazopretendido"/>
                </div>
                <div class="form-group-sm col-xs-1">
                    <label for="valorprestacao">Prestação </label>
                    <input id="valorprestacao" class="form-control no-spinner" string-to-number  min="0" type="number" 
                           ng-model="c.valorprestacao" ng-change="calcularTxEsforco() " ng-change="calcularPoupanca() "/>
                </div>
                <div class="form-group-sm col-xs-1">
                    <label for="diaprestaco">Dia pag. </label>
                    <select id="diaprestacao" class="form-control"  ng-model="c.diaprestacao" >
                        <option value="1">1</option>
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="25">25</option>
                    </select>
                </div>                   
                <div class="form-group-sm col-xs-1" ng-if="c.tipocredito=='CC'">
                    <label for="poupanca">Poupança </label>
                    <input id="poupanca" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="poupanca" readonly=""/>
                </div>
               <div class="form-group-sm col-xs-1" ng-if="c.tipocredito=='CC'">
                    <label for="totalPoupanca">Total </label>
                    <input id="totalPoupanca" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="totalPoupanca" readonly=""/>
                </div>  
                <div class="form-group-sm col-xs-3">
                       <label for="finalidade">Finalidade</label>
                       <input id="finalidade" name="finalidade" class="form-control" type="text" ng-model="c.finalidade" title="Atualizar valores"/>
                 </div> 
            </div>
            
            <!-- Simulações para enviar no email-->
            <div class="col-xs-12" ng-repeat="sim in simulacoes track by $index">
                <div class="form-group-sm col-xs-4">
                    <label ng-if="$index==0"> Tipo Credito <small> [Simulação para incluir no emai]</small> </label>
                      <select id="tipoLead" class="form-control" ng-model="c.sim[$index].tipocredito">
                        <option value="CP" >Pessoal</option>
                        <option value="CC" >Consolidado</option>                        
                        <option value="CCH" >Consolidado com CH</option>
                        <option value="CH1" >CH 1ª Hipoteca</option>
                        <option value="CH2" >CH 2ª Hipoteca</option>
                    </select>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label ng-if="$index==0">Valor </label>
                    <input class="form-control no-spinner" min="0" string-to-number  type="number" ng-model="c.sim[$index].valor"/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label ng-if="$index==0">Prazo </label>
                    <input class="form-control no-spinner" min="0" string-to-number  type="number" ng-model="c.sim[$index].prazo"/>
                </div>
                <div class="form-group-sm col-xs-2">
                    <label ng-if="$index==0">Prestação </label>
                    <input class="form-control no-spinner" min="0" string-to-number  type="number" ng-model="c.sim[$index].prestacao"/>
                </div>
                <div class="form-group-sm col-xs-1">
                    <label ng-if="$index==0">&nbsp;</label>
                    <a ng-if="$index==0" class="btn btn-sm" title="Adicionar uma linha" ng-click="addLineSimula()"><i class="fa fa-plus-circle"></i></a>
                    <a ng-if="$index>0" class="btn btn-sm" title="Remover linha" ng-click="removeLineSimula($index)"><i class="fa fa-minus-circle text-danger"></i></a>
                </div>
            </div>
                        
                <!-- Outras informações -->
            <div class="col-xs-12">        
                <div class="form-group-sm col-xs-12">
                    <label for="outrainfo">Outras informações</label>
                    <textarea id="outrainfo" class="form-control" rows="2" ng-model="c.outrainfo"></textarea>
                    <br/><br/>
                </div>
            </div>
              
             <!-- indicador de taxa de esforço -->
             <div class="col-xs-12">

                 <button type="button" class="btn btn-sm btn-info" ng-click="calcularTxEsforco()" title="Atualizar os calculos"><i class="fa fa-refresh"></i></button>
                 <label>Tx de esfoço: <span class="text-primary">{{txEsforco | number: 2}}%</span></label>
                <div class="progress">
                  <div  class="progress-bar {{progressColor}}" role="progressbar" aria-valuenow="" aria-valuemin="0" aria-valuemax="100" style="width: {{txEsforco}}%">
                  </div>
                </div> 
             </div>
                
            <!-- Butões -->    
            <div class="col-xs-12"> 
                <div class="col-xs-12 text-center">
                    <button ng-if="lead.status==4 || lead.status==5" class="btn btn-primary" type="button" ng-click="finalizarOpc2()">Ir para Detalhe</button>
                    <button class="btn btn-success" type="submit"><i class="fa fa-check"> </i> Finalizar</button>&nbsp;&nbsp;
                    <button class="btn btn-danger" ng-click="rejectLead(lead)"><i class="fa fa-thumbs-down"> </i> Rejeitar</button>&nbsp;&nbsp;
                    <button class="btn btn-warning" onclick="window.location.replace('#')"><i class="fa fa-undo"> </i> Voltar</button>
                </div>
            </div>
        </form>
        </div>
    </div>
</div>
<br/><br/><br/>


<!-- Modal para finalizar. Seleciona o tipo de pedido de documentação.
    Preenche a morada ou confirma o email 
    Regista a data espectavél da receção dos documentos   -->
<script type="text/ng-template" id="modalFinalize.html" ng-controller="modalInstanceFinalize">
<div class="modal-header bg-info">
    <h3 class="modal-title">Documentação Necessária
        <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
</div>
<form ng-submit="saveProcess(d,m,e)">
    <div class="modal-body">
        <div class="container">
            <div class="row">

        <!-- Listagem dos documentos a pedir, com check box para selecionar -->
        <div class="col-md-5">
                <ul class="list-unstyled" ng-repeat="doc in docs1 track by doc.id | orderBy: 'doc.ordem' ">
                    <li>
                        <label>
                            <input class="checkbox-group" type="checkbox" checklist-model="d.docs1" checklist-value="doc"/>
                             {{doc.nomedoc}}
                        </label>
                    </li>
                </ul>
        </div>
        <div class="col-md-5">
                <ul class="list-unstyled" ng-repeat="doc in docs2 track by doc.id | orderBy: 'doc.ordem' ">
                    <li>
                        <label>
                             <input class="checkbox-group" type="checkbox" checklist-model="d.docs2" checklist-value="doc"/> 
                             {{doc.nomedoc}}
                        </label>
                    </li>
                </ul>
        </div> 
                <div class="col-xs-12">    
                    <div class="form-group col-xs-6">
                        <label>
                            <input class="" type="radio" ng-model="e.tipoenvio" value="email"/>
                            Email
                        </label>
                        <label>
                            <input class="" type="radio" ng-model="e.tipoenvio" value="correio"/>
                            Correio
                        </label>
                    </div>
                </div>
                <div class="col-xs-12" ng-show="e.tipoenvio == 'email'"> 
                    <div class="form-group col-xs-8">
                        <input class="form-control" type="email" ng-model="m.email" />
                    </div>
                </div>
                <div class="col-xs-8" ng-show="e.tipoenvio == 'correio'"> 
                    <div class="form-group col-xs-9">
                        <label>Rua</label>
                        <input class="form-control" type="text" ng-model="m.moradarua" />
                    </div>
                    <div class="form-group col-xs-9">
                        <label>Localidade</label>
                        <input class="form-control" type="text" ng-model="m.moradalocalidade" />
                    </div>
                    <div class="form-group col-xs-4">
                        <label>Codigo Postal</label>
                        <input class="form-control" type="text" ng-model="m.moradacp" />
                    </div>
                </div>
                <div class="form-group col-xs-10">
                    <div class="col-xs-3">
                        <label>Data expectavel de receção</label>
                        <input class="form-control" type="date" min="{{minDate}}" ng-model="m.dataExpectavel" required=""/>
                    </div>
                    <div class="col-xs-4">
                    <label>Incluir Simulação
                        <input class="form-control" type="checkbox" ng-model="m.incSimula" ng-checked="true" />
                    </label>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div class="text-center">
            <button class="btn btn-danger" type="button" ng-if="!chamadaTerminada" ng-click="terminarChamada()">
            <i class="fa fa-phone-volume"></i> Desligar</button>
            <button class="btn btn-success" type="submit" ng-if="chamadaTerminada">Guardar</button>
            <a class="btn btn-warning" ng-click="closeModal()">Cancelar</a>
        </div>         
    </div>
</form> 
</script>

<!-- Modal para fazer um agendamento manual  -->
<script type="text/ng-template" id="modalAgendar.html" ng-controller="modalInstanceAgendar"> 
<div class="modal-header bg-info">
    <h3 class="modal-title">Agendamento de contacto
        <span class="closeModal" ng-click="closeModal()">X</span>
    </h3>
</div>
<form ng-submit="saveAgenda(ag)">
    <div class="modal-body">
        <div class="container">
            <div class="row">
                    <div class="form-group col-xs-4">
                        <label for="dataAg">Selecione data</label>
                        <input id="dataAg" name="data" class="form-control" type="date"  ng-model="ag.data" required=""/> 
                    </div>
                    <div class="form-group col-xs-2">
                        <label for="horaAg">Hora</label>
                        <input class="form-control" id="horaAg" type="time" ng-model="ag.hora" min="8:00" max="23:00" />   
                    </div>
                    <div class="form-group col-xs-2">
                        <label for="periodoAg">Periodo</label>
                        <select ng-disabled="ag.hora" class="form-control" id="periodoAg" ng-model="ag.periodo">
                            <option value="">--</option>
                            <option value="1">Manhã</option>
                            <option value="2">Tarde</option>
                        </select>
                    </div>
        
                <div class="form-group col-xs-8">
                    <label>Outras informações</label>
                    <textarea class="form-control" rows="3" ng-model="ag.outraInfo"></textarea>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div class="text-center">
            <button class="btn btn-success" type="submit">Guardar</button>
            <a class="btn btn-warning" ng-click="closeModal()">Cancelar</a>
        </div>         
    </div>
</form> 
</script>


<!-- Modal para mostrar LEADS abertas para o mesmo cliente  -->
<script type="text/ng-template" id="modalOpenLeads.html" ng-controller="modalInstanceOpenLeads">
    <div class="modal-header bg-info">
        <h3 class="modal-title">Lista de LEADS do mesmo cliente
            <span class="closeModal" ng-click="closeModal()">X</span>
        </h3>
    </div>
    <div class="modal-body">
        <table class="table table-condensed">
            <thead class="bg-primary">
                <tr>
                    <th>LEAD</th>
                    <th>Nome</th>
                    <th>NIF</th>
                    <th>Email</th>
                    <th>Telefone</th>
                    <th>Montante</th>
                    <th>Situação</th>
                    <th>Data situação</th>
                    <th>Gestor</th>
                    <th>Analista</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="l in lista">
                    <td ng-click="openLeadDetail(l.id)"><span class="text-primary">{{l.id}}</span></td>
                    <td>{{l.nome}}</td>
                    <td>{{l.nif}}</td>
                    <td>{{l.email}}</td>
                    <td>{{l.telefone}}</td>
                    <td>{{l.montante}}</td>
                    <td>{{l.status}}</td>
                    <td>{{l.datastatus}}</td>
                    <td>{{l.usernome}}</td>
                    <td>{{l.analista}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="modal-footer">
        <div class="text-center">
            <button class="btn btn-warning" ng-click="closeModal()"><i class="fa fa-undo"> </i>Voltar</button>
            <button class="btn btn-danger" ng-click="anularRepetida()" title="Anula a lead puxada porque está repetida. Não envia emails!"><i class="fa fa-times"> </i> Anular por estar repetida</button>
        </div>
    </div>
    
</script>


<!-- Modal para mostrar detalhe de uma LEAD aberta para o mesmo cliente  -->
<script type="text/ng-template" id="modalOpenLeadsDetail.html" ng-controller="modalInstanceOpenLeadsDetail">
    <div class="modal-header bg-info">
        <h3 class="modal-title">Detalhe <span class="text-white">{{dl.id}} - {{dl.tipo}}</span>
            <span class="closeModal" ng-click="closeModal()">X</span>
        </h3>
    </div>
    <div class="modal-body">
   
 <!-- Informações sobre a LEAD -->
        <div class="panel">
            <div class="panel-heading panel-primary">
                <h4>Informação da LEAD </h4>
            </div>
            <div class="panel-body">
                <div class="col-xs-12">
                    <div class="form-group-sm col-sm-2">
                        <label>Fornecedor</label>
                        <input type="text" class="form-control" ng-model="dl.fornecedornome" readonly=""/>
                    </div>
                    <div class="form-group-sm col-sm-2">
                        <label>LEAD original</label>
                        <input type="text" class="form-control" ng-model="dl.idleadorig" readonly=""/>
                    </div>
                    <div class="form-group-sm col-sm-2">
                        <label>Data Entrada</label>
                        <input type="text" class="form-control" ng-model="dl.dataentrada" readonly=""/>
                    </div>                
                    <div class="form-group-sm col-sm-2">
                        <label>Situação</label>
                        <input ng-click="ativar(dl)" type="text" class="form-control" ng-model="dl.nomestatus" readonly=""/>
                    </div>
                    <div class="form-group-sm col-sm-2">
                        <label>Data Situação</label>
                        <input type="text" class="form-control" ng-model="dl.datastatus" readonly=""/>
                    </div>
                    <div class="form-group-sm col-sm-2" ng-if="tipoUser=='Analista'">
                        <label>Gestor</label>
                        <input type="text" class="form-control" ng-model="dl.gestor" readonly=""/>
                    </div>
                    <div class="form-group-sm col-sm-2" ng-if="tipoUser=='Gestor' && dl.status>=12">
                        <label>Analista</label>
                        <input type="text" class="form-control" ng-model="dl.analista" readonly=""/>
                    </div> 
                </div>
                <div class="col-xs-12">
                    <div class="form-group-sm col-sm-2">
                        <label>Origem</label>
                        <input type="text" class="form-control" ng-model="dl.nomelead" readonly=""/>
                    </div>                    
                    <div class="form-group-sm col-sm-5">
                        <label>Situação do crédito</label>
                        <input type="text" class="form-control" ng-model="dl.situacao" readonly=""/>
                    </div>
                    <div class="form-group-sm col-sm-5">
                        <label>Informações </label>
                        <input type="text" class="form-control" ng-model="dl.info" readonly=""/>
                    </div>                    
                </div>
            </div>
        </div>
        
                
           <!--Dados do cliente   -->
            <div class="panel">
                        <div class="panel-heading panel-primary"> 
                            <h4><strong class="text-primary"></strong>Informação do Cliente</h4>
                        </div>
                        <div class="panel-body">
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-10">
                                    <label>Nome </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.nome" title="{{ic.nome}}"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Idade </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.idade"/>
                                </div>
                                <div class="form-group-sm col-xs-3">
                                    <label>Telefone </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.telefone"/>
                                </div>
                                <div class="form-group-sm col-xs-9">
                                    <label>Email </label>
                                    <input id="emailToCopy" ng-readonly="readOnly" class="form-control" type="text" ng-click="copyToClip()" ng-model="ic.email" title="Click para copiar"/>
                                </div>
                                <!-- Morada Postal -->
                                <div ng-if="ic.moradarua || !readOnly">
                                    <div class="form-group-sm col-xs-6">
                                        <label class="text-info">Rua </label>
                                        <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.moradarua"/>
                                    </div> 
                                    <div class="form-group-sm col-xs-4">
                                        <label class="text-info">Localidade </label>
                                        <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.moradalocalidade"/>
                                    </div>                                
                                    <div class="form-group-sm col-xs-2">
                                        <label class="text-info">Codigo Postal </label>
                                        <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.moradacp"/>
                                    </div> 
                                </div>
                                <div class="form-group-sm col-xs-3">
                                    <label>NIF </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.nif"/>
                                </div>
                                <div class="form-group-sm col-sm-2">
                                    <label>IRS</label>
                                    <input type="text" class="form-control" ng-model="ic.irs"  ng-readonly="readOnly"/>
                                </div>                                
                                <div class="form-group-sm col-xs-3">
                                    <label>Estado Civil </label>
                                    <select readonly disabled="" class="form-control" ng-model="ic.estadocivil">
                                        <option ng-repeat="ec in estadoscivis" ng-value="ec.id" ng-selected="ic.estadocivil==ec.id">{{ec.nome}}</option>
                                    </select>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Filhos </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text"  ng-model="ic.filhos"/>
                                </div>
                                <div class="form-group-sm col-xs-4">
                                    <label>Profissão </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.profissao"/>
                                </div>                                
                                <div class="form-group-sm col-xs-4">
                                    <label>Tipo contrato </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.nomecontrato"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label>Inicio </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.anoinicio"/>
                                </div>                                
                                <div class="form-group-sm col-xs-2">
                                    <label>Vencimento </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.vencimento"/>
                                </div>                                
                            </div>
                            <!-- Habitação -->
                            <div class="col-xs-12">
                                <div class="form-group-sm col-sm-4">
                                    <label>Habitação</label>
                                    <input type="text" class="form-control" ng-model="ic.nomehabitacao" ng-readonly="true"/>
                                </div>
                                <div class="form-group-sm col-sm-2" ng-if="ic.valorhabitacao>0">
                                    <label>Renda/Prestação</label>
                                    <input type="text" class="form-control"  ng-model="ic.valorhabitacao" ng-readonly="true"/>
                                </div>
                                <div class="form-group-sm col-sm-2">
                                    <label>Inicio</label>
                                    <input type="text" class="form-control" ng-model="ic.anoiniciohabitacao" ng-readonly="readOnly"/>
                                </div>                 
                                <div class="form-group-sm col-sm-2" ng-if="ic.declarada">
                                    <label>Declarada</label>
                                    <input type="text" class="form-control" ng-model="ic.declarada" ng-readonly="readOnly"/>
                                </div>
                                <div class="form-group-sm col-sm-2" ng-if="ic.mesmahabitacao">
                                    <label class="text-info">Mesma</label>
                                    <input type="text" class="form-control" ng-model="ic.mesmahabitacao" ng-readonly="readOnly"/>
                                </div>
                                <div ng-if="ic.mesmahabitacao=='Não'">
                                    <div class="form-group-sm col-sm-4">
                                        <label class="text-info">Habitação 2º</label>
                                        <input type="text" class="form-control" ng-model="ic.nomehabitacao2" ng-readonly="true"/>
                                    </div>
                                    <div class="form-group-sm col-sm-2" ng-if="ic.valorhabitacao2>0">
                                        <label class="text-info">Renda/Prestação</label>
                                        <input type="text" class="form-control"  ng-model="ic.valorhabitacao2" ng-readonly="readOnly"/>
                                    </div>
                                    <div class="form-group-sm col-sm-2">
                                        <label class="text-info">Inicio</label>
                                        <input type="text" class="form-control" ng-model="ic.anoiniciohabitacao2" ng-readonly="readOnly"/>
                                    </div>                 
                                    <div class="form-group-sm col-sm-2" ng-if="ic.declarada2">
                                        <label class="text-info">Declarada</label>
                                        <input type="text" class="form-control" ng-model="ic.declarada2" ng-readonly="readOnly"/>
                                    </div> 
                                </div>
                            </div>
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-2">
                                    <label class="text-info">Parentesco </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.parentesco2"/>
                                </div>                                
                                <div class="form-group-sm col-xs-2">
                                    <label class="text-info">Idade 2º Prop. </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.idade2"/>
                                </div>
                                <div class="form-group-sm col-xs-3">
                                    <label class="text-info">Telefone </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.telefone2"/>
                                </div>
                                <div class="form-group-sm col-xs-3">
                                    <label class="text-info">NIF </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.nif2"/>
                                </div>
                                <div class="form-group-sm col-xs-4">
                                    <label class="text-info">Profissão </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.profissao2"/>
                                </div>                                
                                <div class="form-group-sm col-xs-4">
                                    <label class="text-info">Tipo contrato </label>
                                    <input readonly class="form-control" type="text" ng-model="ic.nomecontrato2"/>
                                </div> 
                                <div class="form-group-sm col-xs-2">
                                    <label class="text-info">Inicio </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.anoinicio2"/>
                                </div>                                
                                <div class="form-group-sm col-xs-2">
                                    <label class="text-info">Vencimento </label>
                                    <input ng-readonly="readOnly" class="form-control" type="text" ng-model="ic.vencimento2"/>
                                </div>
                                <div class="form-group-sm col-xs-12">
                                    <label>Outras Informações:</label>
                                    <textarea class="form-control" ng-readonly="readOnly" ng-model="ic.outrainfo"></textarea>
                                </div>
                                <div  ng-if="historic.length>0"  class="form-group-sm col-xs-2">
                                    <label class="text-info">Ver </label>
                                    <button class="btn btn-warning btn-sm" ng-click="showHistorico(historic)">Histórico</button>
                                </div> 

                            </div>
                        </div>
                    </div>     
           
            <!--  Credito Pretendido/Rendimentos/Despesas  -->        
                <div class="panel">
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary"></strong>Crédito Pretendido</h4>
                        </div>
                        <div class="panel-body">
                            <div class="col-xs-12">
                                <div class="form-group-sm col-xs-2">
                                    <label for="montante">Valor Pretendido</label>
                                    <input id="montante" name="montante" string-to-number  class="form-control no-spinner" min="0" type="number" ng-model="ic.valorpretendido" ng-readonly="readOnly"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label for="tipoLead">Tipo Crédito</label>                
                                    <select id="tipoLead" class="form-control" ng-model="ic.tipocredito" ng-readonly="readOnly">
                                        <option value="CP" ng-selected="ic.tipocredito=='CP'">CP</option>
                                        <option value="CC" ng-selected="ic.tipocredito=='CC'">CC</option>
                                        <option value="AU" ng-selected="ic.tipocredito=='AU'">Auto</option>
                                    </select>
                                </div>                
                                <div class="form-group-sm col-xs-2">
                                    <label for="numprestacoes">Prazo </label>
                                    <input id="numprestacoes" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="ic.prazopretendido" ng-readonly="readOnly"/>
                                </div>
                                <div class="form-group-sm col-xs-2">
                                    <label for="valorprestacao">Prestação </label>
                                    <input id="valorprestacao" class="form-control no-spinner" string-to-number  min="0" type="number" ng-model="ic.prestacaopretendida"  ng-readonly="readOnly"/>
                                </div>
                                <div class="form-group-sm col-xs-4">
                                    <label for="finalidade">Finalidade</label>
                                    <input id="finalidade" name="finalidade" class="form-control" type="text" ng-model="ic.finalidade"  ng-readonly="readOnly"/>
                                </div>
                            </div>
                            <div class="col-xs-8 col-xs-offset-2">
                                <br/>
                                <table class="table table-condensed" ng-show="rendimentos!=''">
                                    <thead>
                                        <tr>
                                            <th colspan="3" class="text-center">Outros Rendimentos</th>
                                        </tr>
                                        <tr>
                                            <th>Tipo de rendimento</th>
                                            <th>Valor</th>
                                            <th>Periocidade</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="r in rendimentos">
                                            <td class="text-white">{{r.tiporendimento}}</td>
                                            <td class="text-white">{{r.valorrendimento}}€</td>
                                            <td class="text-white">{{r.periocidade}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                               <!-- Outros Creditos -->
                               <br/>
                                <table class="table table-condensed" ng-show="creditos!=''">
                                    <thead>
                                        <tr>
                                            <th colspan="3" class="text-center">Outros Créditos</th>
                                        </tr>                        
                                        <tr>
                                            <th>Tipo de Crédito</th>
                                            <th>Valor Crédito</th>
                                            <th>Prestação</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="c in creditos">
                                            <td class="text-white">{{c.tipocredito}}</td>
                                            <td class="text-white">{{c.valorcredito}}€</td>
                                            <td class="text-white">{{c.prestacao}}€</td>
                                        </tr>
                                    </tbody>
                                </table>   
                            </div>
                        </div>
                    </div>
            
             <!-- Documentos pedidos e recebidos -->
                    <div class="panel">
                        <div class="panel-heading">
                            <h4><strong class="text-primary"></strong>Documentação Pedida / Recebida </h4>
                        </div>
                        <div class="panel-body">
                                <table class="table table-condensed table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>Documento Pedido</th>
                                            <th>Ficheiro</th>
                                            <th>Recebido</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="d in docs">
                                            <td>{{d.nomedoc}}</td>
                                            <td>{{d.nomefx}}</td>
                                            <td ng-if="d.recebido==1" class="text-success">SIM</td>
                                            <td ng-if="d.recebido==0" class="text-danger">NÃO</td> 
                                        </tr>
                                    </tbody>
                                </table>
                        </div>
                    </div>

            <!-- Registo de contactos -->

                    <div class="panel">
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary"></strong>Contactos</h4>
                        </div>
                        <div class="panel-body">
                            <table class="table table-condensed" ng-show="contactos!=''">
                                <thead>
                                    <tr>
                                        <th colspan="3" class="text-center">Historico de Contactos</th>
                                    </tr>
                                    <tr>
                                        <th>Data</th>
                                        <th>Motivo</th>
                                        <th>Gestor</th>
                                        <th>Analista</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="c in contactos">
                                        <td>{{c.data}}</td>
                                        <td>{{c.descricao}}</td>
                                        <td>{{c.gestor}}</td>
                                        <td>{{c.analista}}</td>
                                    </tr>
                                </tbody>
                            </table>  
                        </div>
                    </div>

            <!-- Financiamentos -->
                    <div class="panel">
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary"></strong>Financiamentos</h4>
                        </div>
                        <div class="panel-body">
                            <div class="form-group-sm col-xs-12">
                                <!-- Registo dos financiamentos -->
                                <table class="table table-condensed" ng-show="financiamentos!=''">
                                    <thead>
                                        <tr>
                                            <th colspan="10" class="text-center">Registo dos Pedidos de Financiamento</th>
                                        </tr>                        
                                        <tr>
                                            <th>Processo</th>
                                            <th>Parceiro</th>
                                            <th>Montante</th>
                                            <th>Prazo</th>
                                            <th>Prestação</th>
                                            <th>Contrato Cliente -></th>
                                            <th>Meio</th>
                                            <th>Contrato Parceiro</th>
                                            <th>Data</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="f in financiamentos">
                                            <td>{{f.processo}}</td>
                                            <td>{{f.nome}}</td>
                                            <td>{{f.montante}}</td>
                                            <td>{{f.prazo}}</td>
                                            <td>{{f.prestacao}}</td>
                                            <td>{{f.dtcontratocliente}}</td>
                                            <td>{{f.formaenvio}}</td>
                                            <td>{{f.dtcontratoparceiro}}</td>
                                            <td>{{f.datastatus}}</td>
                                            <td>{{f.statusnome}}</td>
                                            <td ng-if="f.outrainfo">{{f.outrainfo}}"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>                            
                        </div>
                    </div>
         
            <!-- Informações e Rejeições -->
                    <div class="panel">
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary"></strong>Informações</h4>
                        </div>
                        <div class="panel-body">
                            <div class="form-group-sm col-xs-12">
                                <label>Rejeições:</label>
                                <textarea rows="5" class="form-control" ng-readonly="readOnly || tipoUser=='Gestor'" ng-model="rejeicoes"></textarea>
                            </div>                            
                        </div>
                        <div class="panel-body">
                            <div class="form-group-sm col-xs-12">
                                <label>Outras Informações:</label>
                                <textarea rows="5" class="form-control" ng-readonly="readOnly || tipoUser=='Analista'" ng-model="ic.outrainfo"></textarea>
                            </div>                            
                        </div>                        
                    </div>

            <!-- Notas e Observações do Analista-->
                    <div class="panel">
                        <div class="panel-heading panel-primary">
                            <h4><strong class="text-primary"></strong>Notas</h4>
                        </div>
                        <div class="panel-body">
                            <div class="form-group-sm col-xs-12">
                                <label>Notas:</label>
                                <textarea rows="6" class="form-control" ng-model="ic.nota" ng-readonly="readOnly || tipoUser=='Gestor'"></textarea>
                            </div>                            
                        </div>
                    </div> 
    </div>
</script>

